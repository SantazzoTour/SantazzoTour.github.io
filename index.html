<!DOCTYPE html>
<html lang="it">
<head>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9586403432182724"
     crossorigin="anonymous"></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸº SanTazzo - La Notte PiÃ¹ Epica dell'Anno!</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Poppins:wght@300;400;600;700;900&family=Bangers&display=swap" rel="stylesheet">

<style>
    :root {
      --primary-color: #ff6b35;
      --secondary-color: #f7931e;
      --accent-color: #ffd23f;
      --dark-color: #1a1a2e;
      --light-color: #eee;
      --beer-gold: #ffb300;
      --party-pink: #ff006e;
      --party-purple: #8338ec;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      overflow-x: hidden;
      font-size: 16px;
    }

    /* Navbar Super Moderna - MOBILE FIRST */
    .navbar {
      backdrop-filter: blur(10px);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
      border-bottom: 2px solid rgba(255, 255, 255, 0.1);
      padding: 1rem 0;
    }

    .navbar .container {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .navbar-brand {
      font-family: 'Bangers', cursive !important;
      font-size: 2.2rem !important;
      background: linear-gradient(45deg, var(--beer-gold), var(--party-pink), var(--party-purple), var(--beer-gold));
      background-size: 200% 200%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: 4px;
      animation: gradientShift 3s ease infinite, titleBounce 2s ease-in-out infinite;
      white-space: nowrap;
      text-shadow: 0 0 30px rgba(255, 179, 0, 0.5);
      position: relative;
      display: inline-block;
    }

    @keyframes gradientShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    @keyframes titleBounce {
      0%, 100% { transform: translateY(0px) scale(1); }
      50% { transform: translateY(-5px) scale(1.02); }
    }

    /* Animazione birre */
    .beer-icon {
      display: inline-block;
      font-size: 2rem;
      animation: beerSpin 4s ease-in-out infinite;
    }

    .beer-icon:first-child {
      animation-delay: 0s;
    }

    .beer-icon:last-child {
      animation-delay: 0.5s;
    }

    @keyframes beerSpin {
      0%, 100% { transform: rotate(0deg) translateY(0px) scale(1); }
      25% { transform: rotate(-15deg) translateY(-8px) scale(1.1); }
      50% { transform: rotate(0deg) translateY(-3px) scale(1.05); }
      75% { transform: rotate(15deg) translateY(-8px) scale(1.1); }
    }

    /* Tablet navbar */
    @media (min-width: 768px) {
      .navbar {
        padding: 1.2rem 0;
      }

      .navbar-brand {
        font-size: 3rem !important;
        letter-spacing: 6px;
      }

      .beer-icon {
        font-size: 2.5rem;
      }

      @keyframes beerSpin {
        0%, 100% { transform: rotate(0deg) translateY(0px) scale(1); }
        25% { transform: rotate(-20deg) translateY(-12px) scale(1.15); }
        50% { transform: rotate(0deg) translateY(-5px) scale(1.08); }
        75% { transform: rotate(20deg) translateY(-12px) scale(1.15); }
      }
    }

    /* Desktop navbar */
    @media (min-width: 992px) {
      .navbar {
        padding: 1.5rem 0;
      }

      .navbar-brand {
        font-size: 3.5rem !important;
        letter-spacing: 8px;
      }

      .beer-icon {
        font-size: 3rem;
      }
    }

    /* Hero Section con Timer Spettacolare - MOBILE FIRST */
    .hero-section {
      background: linear-gradient(180deg, 
        #fff9e6 0%,      /* Schiuma chiara in alto */
        #ffe8a8 8%,      /* Schiuma */
        #ffd966 15%,     /* Transizione schiuma-birra */
        #f5c842 20%,     /* Birra dorata */
        #f0b429 40%,     /* Birra ambrata */
        #e8a614 70%,     /* Birra piÃ¹ scura */
        #d89b0d 100%);   /* Fondo scuro */
      min-height: 80vh;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      position: relative;
      overflow: hidden;
      padding: 65px 13px 30px;
    }

    /* Desktop parallax effect */
    @media (min-width: 768px) {
      .hero-section {
        padding: 120px 20px 50px;
        align-items: center;
      }
    }

    /* Schiuma superiore animata */
    .hero-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 120px;
      background: linear-gradient(180deg, 
        rgba(255, 255, 255, 0.95) 0%,
        rgba(255, 249, 230, 0.9) 30%,
        rgba(255, 232, 168, 0.7) 60%,
        rgba(255, 217, 102, 0.4) 85%,
        transparent 100%);
      z-index: 0;
      animation: foam-wave 8s ease-in-out infinite;
    }

    @keyframes foam-wave {
      0%, 100% { 
        transform: translateY(0px);
        opacity: 0.9;
      }
      50% { 
        transform: translateY(-5px);
        opacity: 1;
      }
    }

    /* Effetto texture della schiuma */
    .hero-section::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 100px;
      background-image: 
        radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.3) 0%, transparent 3%),
        radial-gradient(circle at 60% 20%, rgba(255, 255, 255, 0.25) 0%, transparent 4%),
        radial-gradient(circle at 40% 50%, rgba(255, 255, 255, 0.2) 0%, transparent 3%),
        radial-gradient(circle at 80% 40%, rgba(255, 255, 255, 0.28) 0%, transparent 3.5%),
        radial-gradient(circle at 15% 70%, rgba(255, 255, 255, 0.22) 0%, transparent 3%),
        radial-gradient(circle at 90% 70%, rgba(255, 255, 255, 0.26) 0%, transparent 4%),
        radial-gradient(circle at 50% 80%, rgba(255, 255, 255, 0.24) 0%, transparent 3%);
      background-size: 100% 100%;
      z-index: 1;
      animation: foam-texture 10s ease-in-out infinite;
    }

    @keyframes foam-texture {
      0%, 100% { 
        opacity: 0.7;
        transform: translateX(0) scale(1);
      }
      50% { 
        opacity: 0.9;
        transform: translateX(10px) scale(1.05);
      }
    }

    @keyframes gradient-shift {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 0.8; }
    }

    .timer-container {
      background: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(15px);
      padding: 2rem 1.2rem;
      border-radius: 20px;
      border: 2px solid transparent;
      background-image: linear-gradient(rgba(0, 0, 0, 0.9), rgba(0, 0, 0, 0.9)), 
                        linear-gradient(135deg, var(--beer-gold), var(--party-pink), var(--party-purple));
      background-origin: border-box;
      background-clip: padding-box, border-box;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5), 
                  0 0 50px rgba(255, 179, 0, 0.2);
      animation: float 6s ease-in-out infinite;
      position: relative;
      z-index: 1;
      width: 100%;
      max-width: 100%;
    }

    /* Desktop timer */
    @media (min-width: 768px) {
      .timer-container {
        padding: 2.5rem 2rem;
        border-radius: 30px;
        border: 3px solid transparent;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5), 
                    0 0 100px rgba(255, 179, 0, 0.3);
      }
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }

    /* Desktop float more */
    @media (min-width: 768px) {
      @keyframes float {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-20px); }
      }
    }

    #titolo {
      font-family: 'Bangers', cursive;
      font-size: 1.3rem;
      background: linear-gradient(45deg, var(--beer-gold), var(--accent-color), var(--beer-gold));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: title-glow 3s ease-in-out infinite;
      letter-spacing: 2px;
      margin-bottom: 0.8rem;
      line-height: 1.2;
    }

    /* Desktop title */
    @media (min-width: 768px) {
      #titolo {
        font-size: 3rem;
        letter-spacing: 3px;
        margin-bottom: 1rem;
      }
    }

    @media (min-width: 992px) {
      #titolo {
        font-size: 4rem;
        letter-spacing: 4px;
      }
    }

    @keyframes title-glow {
      0%, 100% { text-shadow: 0 0 10px rgba(255, 179, 0, 0.6); }
      50% { text-shadow: 0 0 20px rgba(255, 179, 0, 0.8); }
    }

    /* Desktop title glow */
    @media (min-width: 768px) {
      @keyframes title-glow {
        0%, 100% { text-shadow: 0 0 20px rgba(255, 179, 0, 0.8); }
        50% { text-shadow: 0 0 40px rgba(255, 179, 0, 1); }
      }
    }

    #data {
      font-size: 1.1rem;
      font-weight: 300;
      color: var(--accent-color);
      margin-bottom: 1.8rem;
      letter-spacing: 1px;
    }

    /* Desktop data */
    @media (min-width: 768px) {
      #data {
        font-size: 1.3rem;
        margin-bottom: 2rem;
        letter-spacing: 2px;
      }
    }

    @media (min-width: 992px) {
      #data {
        font-size: 1.5rem;
      }
    }

    #timer {
      display: flex;
      justify-content: center;
      gap: 0.5rem;
      flex-wrap: nowrap;
      overflow-x: auto;
      overflow-y: hidden;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    #timer::-webkit-scrollbar {
      display: none;
    }

    /* Desktop timer gap */
    @media (min-width: 768px) {
      #timer {
        gap: 1.5rem;
      }
    }

    @media (min-width: 992px) {
      #timer {
        gap: 2rem;
      }
    }

    #timer > div {
      background: linear-gradient(135deg, var(--party-purple), var(--party-pink));
      padding: 0.8rem 0.7rem;
      border-radius: 12px;
      min-width: 70px;
      flex: 0 0 auto;
      max-width: none;
      box-shadow: 0 5px 20px rgba(255, 0, 110, 0.3);
      transform: translateY(0);
      transition: all 0.3s ease;
      animation: pulse 2s ease-in-out infinite;
    }

    /* Desktop timer cards */
    @media (min-width: 768px) {
      #timer > div {
        padding: 1.2rem 1.5rem;
        border-radius: 18px;
        min-width: 100px;
        max-width: 110px;
        box-shadow: 0 8px 25px rgba(255, 0, 110, 0.35);
      }
    }

    @media (min-width: 992px) {
      #timer > div {
        padding: 1.5rem 2rem;
        border-radius: 20px;
        min-width: 120px;
        max-width: none;
        flex: 0;
        box-shadow: 0 10px 30px rgba(255, 0, 110, 0.4);
      }

      #timer > div:hover {
        transform: translateY(-10px) scale(1.1);
        box-shadow: 0 15px 40px rgba(255, 0, 110, 0.6);
      }
    }

    #timer > div:nth-child(1) { animation-delay: 0s; }
    #timer > div:nth-child(2) { animation-delay: 0.2s; }
    #timer > div:nth-child(3) { animation-delay: 0.4s; }
    #timer > div:nth-child(4) { animation-delay: 0.6s; }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    #timer > div .number {
      display: block;
      font-size: 2rem;
      font-weight: 900;
      font-family: 'Bebas Neue', cursive;
      color: white;
      line-height: 1;
      margin-bottom: 0.2rem;
    }

    /* Desktop timer numbers */
    @media (min-width: 768px) {
      #timer > div .number {
        font-size: 2.8rem;
        margin-bottom: 0.4rem;
      }
    }

    @media (min-width: 992px) {
      #timer > div .number {
        font-size: 3.5rem;
        margin-bottom: 0.5rem;
      }
    }

    #timer > div span {
      display: block;
      font-size: 0.65rem;
      font-weight: 600;
      color: var(--accent-color);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Desktop timer labels */
    @media (min-width: 768px) {
      #timer > div span {
        font-size: 0.8rem;
        letter-spacing: 1.5px;
      }
    }

    @media (min-width: 992px) {
      #timer > div span {
        font-size: 0.9rem;
        letter-spacing: 2px;
      }
    }

    /* Navigation Buttons sotto il Timer */
    .navigation-buttons {
      display: flex;
      gap: 0.8rem;
      justify-content: center;
      margin-top: 2.5rem;
      flex-wrap: wrap;
      padding: 0 10px;
    }

    .nav-btn {
      background: linear-gradient(135deg, var(--beer-gold), var(--secondary-color));
      border: none;
      border-radius: 50px;
      padding: 0.9rem 1.5rem;
      color: white;
      font-weight: 700;
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 5px 20px rgba(255, 179, 0, 0.4);
      display: flex;
      align-items: center;
      gap: 0.5rem;
      position: relative;
      overflow: hidden;
      flex: 1;
      min-width: 150px;
      justify-content: center;
    }

    .nav-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.3);
      transition: left 0.5s ease;
    }

    .nav-btn:active::before {
      left: 100%;
    }

    .nav-btn:active {
      transform: scale(0.95);
      box-shadow: 0 3px 15px rgba(255, 179, 0, 0.5);
    }

    .btn-emoji {
      font-size: 1.3rem;
      animation: emoji-bounce 2s ease-in-out infinite;
    }

    .btn-text {
      white-space: nowrap;
    }

    .nav-btn:nth-child(1) {
      background: linear-gradient(135deg, var(--party-purple), var(--party-pink));
      box-shadow: 0 5px 20px rgba(131, 56, 236, 0.4);
    }

    .nav-btn:nth-child(2) {
      background: linear-gradient(135deg, var(--party-pink), #ff4d6d);
      box-shadow: 0 5px 20px rgba(255, 0, 110, 0.4);
    }

    .nav-btn:nth-child(3) {
      background: linear-gradient(135deg, var(--beer-gold), var(--secondary-color));
      box-shadow: 0 5px 20px rgba(255, 179, 0, 0.4);
    }

    /* Desktop navigation buttons */
    @media (min-width: 768px) {
      .navigation-buttons {
        gap: 1.2rem;
        margin-top: 3rem;
      }

      .nav-btn {
        padding: 1rem 2rem;
        font-size: 0.95rem;
        letter-spacing: 1.5px;
        flex: 0;
        min-width: auto;
      }

      .nav-btn:hover::before {
        left: 100%;
      }

      .nav-btn:hover {
        transform: translateY(-5px) scale(1.05);
      }

      .nav-btn:nth-child(1):hover {
        box-shadow: 0 10px 30px rgba(131, 56, 236, 0.6);
      }

      .nav-btn:nth-child(2):hover {
        box-shadow: 0 10px 30px rgba(255, 0, 110, 0.6);
      }

      .nav-btn:nth-child(3):hover {
        box-shadow: 0 10px 30px rgba(255, 179, 0, 0.6);
      }

      .btn-emoji {
        font-size: 1.5rem;
      }
    }

    @media (min-width: 992px) {
      .nav-btn {
        padding: 1.1rem 2.5rem;
        font-size: 1rem;
        letter-spacing: 2px;
      }

      .btn-emoji {
        font-size: 1.8rem;
      }
    }

    /* Content Sections - MOBILE FIRST */
    .content-section {
      background: white;
      border-radius: 0;
      position: relative;
      z-index: 2;
      padding: 0 15px;
    }

    .section-title {
      font-family: 'Bangers', cursive;
      font-size: 2rem;
      text-align: center;
      margin: 2rem 0 1.5rem;
      background: linear-gradient(45deg, var(--party-purple), var(--party-pink));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: 2px;
      line-height: 1.3;
      padding: 0 10px;
    }

    /* Desktop section title */
    @media (min-width: 768px) {
      .section-title {
        font-size: 2.5rem;
        margin: 2.5rem 0 2rem;
        letter-spacing: 2.5px;
      }
    }

    @media (min-width: 992px) {
      .section-title {
        font-size: 3rem;
        margin: 3rem 0 2rem;
        letter-spacing: 3px;
      }
    }

    .info-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
      margin: 1.5rem 0;
      position: relative;
      overflow: hidden;
      padding: 13px;
    }

    /* Desktop info card */
    @media (min-width: 768px) {
      .info-card {
        padding: 2rem;
        border-radius: 25px;
        box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
        margin: 2rem 0;
      }
    }

    @media (min-width: 992px) {
      .info-card {
        padding: 2.5rem;
      }
    }

    .info-card::before {
      content: 'ğŸº';
      position: absolute;
      font-size: 8rem;
      opacity: 0.08;
      right: -20px;
      top: -20px;
      animation: rotate 20s linear infinite;
    }

    /* Desktop info card emoji */
    @media (min-width: 768px) {
      .info-card::before {
        font-size: 12rem;
        opacity: 0.1;
        right: -30px;
        top: -30px;
      }
    }

    @media (min-width: 992px) {
      .info-card::before {
        font-size: 15rem;
        right: -50px;
        top: -50px;
      }
    }

    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    /* Nasconde la birra solo nella sezione "Entra nel quiz" */
    #participantLogin.info-card::before {
      display: none;
    }

    .info-card p {
      font-size: 1.05rem;
      line-height: 1.75;
      position: relative;
      z-index: 1;
    }

    /* Desktop info card text */
    @media (min-width: 768px) {
      .info-card p {
        font-size: 1.1rem;
        line-height: 1.8;
      }
    }

    @media (min-width: 992px) {
      .info-card p {
        font-size: 1.15rem;
        line-height: 1.85;
      }
    }

    .hashtags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.7rem;
      margin: 1.5rem 0;
      justify-content: center;
    }

    /* Desktop hashtags */
    @media (min-width: 768px) {
      .hashtags {
        gap: 1rem;
        margin: 2rem 0;
      }
    }

    .hashtag {
      background: linear-gradient(135deg, var(--party-pink), var(--party-purple));
      color: white;
      padding: 0.6rem 1.2rem;
      border-radius: 50px;
      font-weight: 700;
      font-size: 0.9rem;
      box-shadow: 0 4px 12px rgba(131, 56, 236, 0.3);
      transition: all 0.3s ease;
      cursor: pointer;
    }

    /* Desktop hashtags */
    @media (min-width: 768px) {
      .hashtag {
        padding: 0.8rem 1.5rem;
        font-size: 1.1rem;
        box-shadow: 0 5px 15px rgba(131, 56, 236, 0.4);
      }

      .hashtag:hover {
        transform: translateY(-5px) scale(1.1);
        box-shadow: 0 10px 25px rgba(131, 56, 236, 0.6);
      }
    }

    /* Form Section - MOBILE FIRST */
    .form-section {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      padding-top:20px;
      border-radius: 20px;
      margin: 2rem 0;
      box-shadow: 0 15px 40px rgba(245, 87, 108, 0.3);
    }

    /* Desktop form section */
    @media (min-width: 768px) {
      .form-section {
        padding: 2.5rem 2rem;
        border-radius: 25px;
        margin: 2.5rem 0;
        box-shadow: 0 18px 50px rgba(245, 87, 108, 0.35);
      }
    }

    @media (min-width: 992px) {
      .form-section {
        padding: 3rem;
        border-radius: 30px;
        margin: 3rem 0;
        box-shadow: 0 20px 60px rgba(245, 87, 108, 0.4);
      }
    }

    .embed-responsive {
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      position: relative;
      height: 515px;
    }

    .embed-responsive iframe {
      width: 100%;
      min-height: 800px;
    }

    /* Desktop embed */
    @media (min-width: 768px) {
      .embed-responsive {
        border-radius: 20px;
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
      }

      .embed-responsive iframe {
        min-height: 900px;
      }
    }

    @media (min-width: 992px) {
      .embed-responsive iframe {
        min-height: 1000px;
      }
    }

    /* Buttons - MOBILE FIRST */
    .btn-modern {
      background: linear-gradient(135deg, var(--party-pink), var(--party-purple)) !important;
      border: none !important;
      padding: 0.9rem 1.5rem !important;
      border-radius: 50px !important;
      font-weight: 700 !important;
      font-size: 0.95rem !important;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 8px 25px rgba(131, 56, 236, 0.4);
      transition: all 0.3s ease !important;
      position: relative;
      overflow: hidden;
      color:white;
    }

    /* Desktop buttons */
    @media (min-width: 768px) {
      .btn-modern {
        padding: 1rem 2rem !important;
        font-size: 1.1rem !important;
        letter-spacing: 1.5px;
        box-shadow: 0 10px 30px rgba(131, 56, 236, 0.4);
      }
    }

    @media (min-width: 992px) {
      .btn-modern {
        padding: 1rem 2.5rem !important;
        font-size: 1.2rem !important;
        letter-spacing: 2px;
      }
    }

    .btn-modern::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.3);
      transition: left 0.5s ease;
    }

    .btn-modern:active::before {
      left: 100%;
    }

    .btn-modern:active {
      transform: scale(0.95);
    }

    /* Desktop button hover */
    @media (min-width: 768px) {
      .btn-modern:hover::before {
        left: 100%;
      }

      .btn-modern:hover {
        transform: translateY(-5px) scale(1.05);
        box-shadow: 0 15px 40px rgba(131, 56, 236, 0.6) !important;
      }
    }

    /* Table Modern - MOBILE FIRST */
    .table-modern {
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
    }

    /* Desktop table */
    @media (min-width: 768px) {
      .table-modern {
        border-radius: 20px;
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
      }
    }

    .table-modern thead {
      background: linear-gradient(135deg, var(--party-purple), var(--party-pink));
      color: white;
    }

    .table-modern th {
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      padding: 1rem !important;
      font-size: 0.9rem;
    }

    /* Desktop table header */
    @media (min-width: 768px) {
      .table-modern th {
        letter-spacing: 1px;
        padding: 1.2rem !important;
        font-size: 1rem;
      }
    }

    @media (min-width: 992px) {
      .table-modern th {
        padding: 1.5rem !important;
        font-size: 1.1rem;
      }
    }

    .table-modern tbody tr {
      transition: all 0.3s ease;
    }

    .table-modern tbody tr:active {
      background: linear-gradient(90deg, rgba(131, 56, 236, 0.08), rgba(255, 0, 110, 0.08));
    }

    /* Desktop table row hover */
    @media (min-width: 768px) {
      .table-modern tbody tr:hover {
        background: linear-gradient(90deg, rgba(131, 56, 236, 0.1), rgba(255, 0, 110, 0.1));
        transform: scale(1.02);
      }
    }

    .table-modern td {
      padding: 0.9rem !important;
      font-size: 0.9rem;
      font-weight: 500;
    }

    /* Desktop table cells */
    @media (min-width: 768px) {
      .table-modern td {
        padding: 1rem !important;
        font-size: 0.95rem;
      }
    }

    @media (min-width: 992px) {
      .table-modern td {
        padding: 1.2rem !important;
        font-size: 1rem;
      }
    }

    /* Tappe Section - MOBILE FIRST */
    .tappe-card {
      background: white;
      border-radius: 15px;
      margin: 1.5rem 0;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
    }

    /* Desktop tappe card */
    @media (min-width: 768px) {
      .tappe-card {
        border-radius: 20px;
        padding: 1.5rem;
        margin: 2rem 0;
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
      }
    }

    @media (min-width: 992px) {
      .tappe-card {
        padding: 2rem;
      }
    }

    .tappa-link {
      color: var(--party-purple);
      font-weight: 700;
      text-decoration: none;
      transition: all 0.3s ease;
      font-size: 0.95rem;
      display: inline-block;
    }

    /* Desktop tappa link */
    @media (min-width: 768px) {
      .tappa-link {
        font-size: 1.05rem;
      }
    }

    @media (min-width: 992px) {
      .tappa-link {
        font-size: 1.1rem;
      }

      .tappa-link:hover {
        color: var(--party-pink);
        transform: translateX(10px);
      }
    }

    .tappa-link:active {
      color: var(--party-pink);
      transform: scale(0.95);
    }

    /* Responsive - MOBILE OPTIMIZATIONS */
    @media (max-width: 767px) {
      body {
        font-size: 14px;
      }

      .container {
        padding-left: 15px;
        padding-right: 15px;
      }

      /* Riduce padding generale */
      .content-section {
        padding: 0 10px;
      }

      /* Migliora spaziatura emoji nel titolo */
      .emoji-float {
        font-size: 1.2rem;
      }

      .section-title .emoji-float {
        display: block;
        margin: 0.3rem 0;
      }

      /* Ottimizza form title su mobile */
      .form-section h3 {
        font-size: 1.5rem !important;
        line-height: 1.4;
        padding: 0 10px;
      }

      .form-section h3 .emoji-float {
        font-size: 1.3rem;
      }
    }

    /* Tablet adjustments */
    @media (min-width: 768px) and (max-width: 991px) {
      .navbar-brand {
        font-size: 2rem !important;
      }

      #titolo {
        font-size: 2.8rem;
      }

      #timer > div {
        min-width: 95px;
      }
    }

    /* Large desktop */
    @media (min-width: 1200px) {
      .container {
        max-width: 1140px;
      }

      .timer-container {
        max-width: 900px;
        margin: 0 auto;
      }
    }

    /* Animazioni Emoji - Ottimizzate per mobile */
    .emoji-float {
      display: inline-block;
      animation: emoji-bounce 2s ease-in-out infinite;
    }

    @keyframes emoji-bounce {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      25% { transform: translateY(-5px) rotate(-3deg); }
      75% { transform: translateY(-3px) rotate(3deg); }
    }

    /* Desktop emoji animation piÃ¹ pronunciata */
    @media (min-width: 768px) {
      @keyframes emoji-bounce {
        0%, 100% { transform: translateY(0px) rotate(0deg); }
        25% { transform: translateY(-10px) rotate(-5deg); }
        75% { transform: translateY(-5px) rotate(5deg); }
      }
    }

    /* Migliora touch targets per mobile */
    @media (max-width: 767px) {
      .nav-link {
        min-height: 44px;
        display: flex;
        align-items: center;
      }

      .btn-modern {
        min-height: 48px;
        touch-action: manipulation;
      }

      .hashtag {
        min-height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
    }
  </style>
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
</head>

<body onscroll="percentuale()">
	<nav class="navbar fixed-top navbar-expand-lg navbar-dark">
	  <div class="container" style="justify-content: center;">
  	  <a class="navbar-brand" href="#" style="margin: 0;">
        <span class="emoji-float beer-icon">ï¿½</span> 
        SANTAZZO 
        <span class="emoji-float beer-icon">ğŸº</span>
      </a>
	 	</div>
	</nav>

<div class="hero-section">
<div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-10 col-md-12">
        <div class="timer-container">
            <div id="titolo" style="text-align: center;"></div> 
            <div id="data" style="text-align: center;"></div>    
            <div id="timer" style="text-align: center;"></div>
            
            <!-- Bottoni di navigazione -->
            <div class="navigation-buttons">
              <button class="nav-btn" id="btnCosa">
                <span class="btn-emoji">ğŸŠ</span>
                <span class="btn-text">Cosa si festeggia</span>
              </button>
              <button class="nav-btn" id="btnIscriviti">
                <span class="btn-emoji">ğŸ“</span>
                <span class="btn-text">Iscriviti</span>
              </button>
              <button class="nav-btn" id="btnTappe">
                <span class="btn-emoji">ğŸ—ºï¸</span>
                <span class="btn-text">Le Tappe</span>
              </button>
              <button class="nav-btn" id="btnQuiz" style="display: none;">
                <span class="btn-emoji">ğŸ¯</span>
                <span class="btn-text">Quiz Tappe</span>
              </button>
            </div>
        </div>
      </div>
    </div>  
</div>
<!-- Birre animate di sfondo -->
<div class="beer-bg" id="beerBackground"></div>
</div>

<style>
.beer-bg {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 0;
}

.floating-beer {
  position: absolute;
  font-size: 2.5rem;
  opacity: 0.15;
  animation-timing-function: ease-in-out;
  animation-iteration-count: infinite;
  filter: blur(0.5px);
}

/* Bollicine della birra */
.bubble {
  position: absolute;
  bottom: -50px;
  background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.8), rgba(255, 235, 120, 0.4));
  border-radius: 50%;
  opacity: 0.6;
  animation-timing-function: linear;
  animation-iteration-count: infinite;
  box-shadow: 
    inset -2px -2px 4px rgba(255, 255, 255, 0.5),
    0 0 4px rgba(255, 200, 0, 0.3);
}

@keyframes bubble-rise-1 {
  0% {
    bottom: -50px;
    opacity: 0;
    transform: translateX(0) scale(0.8);
  }
  10% {
    opacity: 0.6;
  }
  90% {
    opacity: 0.4;
  }
  100% {
    bottom: 100%;
    opacity: 0;
    transform: translateX(30px) scale(1.2);
  }
}

@keyframes bubble-rise-2 {
  0% {
    bottom: -50px;
    opacity: 0;
    transform: translateX(0) scale(0.9);
  }
  10% {
    opacity: 0.7;
  }
  90% {
    opacity: 0.3;
  }
  100% {
    bottom: 100%;
    opacity: 0;
    transform: translateX(-40px) scale(1.1);
  }
}

@keyframes bubble-rise-3 {
  0% {
    bottom: -50px;
    opacity: 0;
    transform: translateX(0) scale(0.7);
  }
  10% {
    opacity: 0.8;
  }
  90% {
    opacity: 0.5;
  }
  100% {
    bottom: 100%;
    opacity: 0;
    transform: translateX(20px) scale(1);
  }
}

@keyframes bubble-rise-4 {
  0% {
    bottom: -50px;
    opacity: 0;
    transform: translateX(0) scale(1);
  }
  10% {
    opacity: 0.6;
  }
  50% {
    transform: translateX(-15px) scale(1.1);
  }
  90% {
    opacity: 0.4;
  }
  100% {
    bottom: 100%;
    opacity: 0;
    transform: translateX(10px) scale(0.9);
  }
}

@keyframes bubble-rise-5 {
  0% {
    bottom: -50px;
    opacity: 0;
    transform: translateX(0) scale(0.85);
  }
  10% {
    opacity: 0.7;
  }
  50% {
    transform: translateX(25px) scale(1.15);
  }
  90% {
    opacity: 0.3;
  }
  100% {
    bottom: 100%;
    opacity: 0;
    transform: translateX(-20px) scale(1.05);
  }
}

@keyframes float-diagonal-1 {
  0%, 100% { 
    transform: translate(0, 0) rotate(0deg);
  }
  50% { 
    transform: translate(50px, -100px) rotate(180deg);
  }
}

@keyframes float-diagonal-2 {
  0%, 100% { 
    transform: translate(0, 0) rotate(0deg) scale(1);
  }
  50% { 
    transform: translate(-60px, 80px) rotate(-180deg) scale(1.2);
  }
}

@keyframes float-diagonal-3 {
  0%, 100% { 
    transform: translate(0, 0) rotate(0deg);
  }
  33% { 
    transform: translate(40px, 60px) rotate(120deg);
  }
  66% { 
    transform: translate(-30px, -40px) rotate(240deg);
  }
}

@keyframes float-diagonal-4 {
  0%, 100% { 
    transform: translate(0, 0) rotate(0deg) scale(1);
  }
  50% { 
    transform: translate(70px, -60px) rotate(360deg) scale(0.8);
  }
}

@keyframes float-diagonal-5 {
  0%, 100% { 
    transform: translate(0, 0) rotate(0deg);
  }
  25% { 
    transform: translate(-50px, -70px) rotate(-90deg);
  }
  75% { 
    transform: translate(60px, 50px) rotate(90deg);
  }
}

@keyframes float-diagonal-6 {
  0%, 100% { 
    transform: translate(0, 0) rotate(0deg) scale(1);
  }
  50% { 
    transform: translate(-80px, -50px) rotate(180deg) scale(1.1);
  }
}
</style>

<script>
// Crea bollicine animate nello sfondo (effetto birra)
function createBeerBubbles() {
  const beerBg = document.getElementById('beerBackground');
  const numberOfBubbles = window.innerWidth < 768 ? 25 : 50; // PiÃ¹ bollicine su desktop
  
  for (let i = 0; i < numberOfBubbles; i++) {
    const bubble = document.createElement('div');
    bubble.className = 'bubble';
    
    // Posizione orizzontale casuale
    bubble.style.left = Math.random() * 100 + '%';
    
    // Dimensione casuale (bollicine piccole)
    const size = Math.random() * 8 + 3; // 3-11px
    bubble.style.width = size + 'px';
    bubble.style.height = size + 'px';
    
    // Animazione casuale
    const animationNum = (i % 5) + 1;
    const duration = Math.random() * 6 + 4; // 4-10 secondi
    bubble.style.animation = `bubble-rise-${animationNum} ${duration}s linear infinite`;
    bubble.style.animationDelay = Math.random() * 5 + 's';
    
    beerBg.appendChild(bubble);
  }
}

// Esegui quando il DOM Ã¨ pronto
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', createBeerBubbles);
} else {
  createBeerBubbles();
}
</script>

<div class="container content-section"><div class="row"><div class="col-md-12 col-xs-12" style="padding-top:1px; padding-bottom:10px">
<!--
<div style="visibility: hidden" class="d-flex justify-content-center"><img src="./img/alert-triangle.svg" alt="Alert"><h4 class="text-success">
  &nbsp Ore 20:00 ritrovo al Bar Mania &nbsp 
</h4><img src="./img/alert-triangle.svg" alt="Alert"></div> 
-->
<!--
<div style="visibility: hidden"  class="d-flex justify-content-center">
  <h3>
    Domande?  
  </h3>
</div>
<div style="visibility: hidden"  class="d-flex justify-content-center">
<a class="btn btn-outline-primary" role="button" href="https://telegram.me/santazzo">Unisciti al Gruppo Telegram <img src="./img/icons8-telegram-app.svg" alt="Alert"></a>
</div>
</div>
	
<!-- SEZIONE QUIZ TAPPE -->
<div class="container" id="quizSection" style="margin-top: 1px; margin-bottom: 3rem; display: none;">
  <div class="section-title">
     QUIZ
  </div>

  <!-- Pannello Amministratore (Password Protected) -->
  <div id="adminPanel" style="display: none;">
    <div class="info-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
      <h4 style="font-family: 'Bangers', cursive; font-size: 1.8rem; text-align: center; margin-bottom: 1.5rem;">
        ğŸ‘‘ PANNELLO AMMINISTRATORE ğŸ‘‘
      </h4>
      
      <div style="color:black">
        <label style="font-weight: 600; margin-bottom: 0.5rem; display: block;">ğŸ“ Seleziona Tappa:</label>
        <select id="adminTappaSelect" class="form-control" style="margin-bottom: 1rem; padding: 0.8rem; border-radius: 10px; font-size: 1rem;">
          <option value="1">Tappa - 1</option>
          <option value="2">Tappa - 2</option>
          <option value="3">Tappa - 3</option>
          <option value="4">Tappa - 4</option>
          <option value="5">Tappa - 5</option>
          <option value="6">Tappa - 6</option>
          <option value="7">Tappa - 7</option>
          <option value="8">Tappa - 8</option>
        </select>

        <label style="font-weight: 600; margin-bottom: 0.5rem; display: block;">â“ Inserisci Domanda:</label>
        <textarea id="adminQuestion" class="form-control" rows="3" placeholder="Es: Quale Ã¨ il fiume che attraversa Cisano?" style="margin-bottom: 1rem; padding: 0.8rem; border-radius: 10px; font-size: 1rem;"></textarea>

        <label style="font-weight: 600; margin-bottom: 0.5rem; display: block;">âœ… Risposta Corretta:</label>
        <input type="text" id="adminAnswer" class="form-control" placeholder="Es: Brembo (per piÃ¹ risposte separale con virgola: Brembo, Fiume Brembo)" style="margin-bottom: 0.3rem; padding: 0.8rem; border-radius: 10px; font-size: 1rem;">
        <small style="color: #666; font-size: 0.85rem; margin-bottom: 1.5rem; display: block;">
          ğŸ’¡ Puoi inserire piÃ¹ risposte corrette separandole con la virgola
        </small>

        <button onclick="startQuiz()" class="btn btn-modern" style="width: 100%; padding: 1rem !important; font-size: 1.2rem !important;">
          ğŸš€ AVVIA QUIZ
        </button>
      </div>

      <div id="activeQuizAdmin" style="display: none; background: rgba(0,0,0,0.2); padding: 1.5rem; border-radius: 15px; margin-top: 1rem;">
        <h5 style="font-family: 'Bangers', cursive; font-size: 1.5rem; text-align: center; margin-bottom: 1rem;">
          â±ï¸ QUIZ IN CORSO
        </h5>
        <div id="adminQuestionDisplay" style="background: white; color: #333; padding: 1rem; border-radius: 10px; margin-bottom: 1rem; font-weight: 600; font-size: 1.1rem; text-align: center;"></div>
        
        <h6 style="font-weight: 700; margin-top: 1.5rem; margin-bottom: 0.8rem;">ğŸ“Š RISPOSTE RICEVUTE:</h6>
        <div id="answersReceived" style="background: white; color: #333; padding: 1rem; border-radius: 10px; max-height: 300px; overflow-y: auto;">
          <p style="text-align: center; opacity: 0.6;">In attesa di risposte...</p>
        </div>

        <button onclick="endQuiz()" class="btn btn-modern" style="width: 100%; margin-top: 1rem; background: linear-gradient(135deg, #ff6b6b, #ee5a6f) !important;">
          ğŸ›‘ TERMINA QUIZ
        </button>
      </div>
    </div>
  </div>

  <!-- Interfaccia Partecipante -->
  <div id="participantPanel">
    <!-- Login Partecipante -->
    <div id="participantLogin" class="info-card">
      <h4 style="font-family: 'Bangers', cursive; font-size: 1.8rem; text-align: center; margin-bottom: 1.5rem;">
        ğŸ® ENTRA NEL QUIZ!
      </h4>
      <div style="max-width: 400px; margin: 0 auto;">
        <input type="text" id="participantName" class="form-control" placeholder="Inserisci il tuo nome" style="margin-bottom: 1rem; padding: 1rem; border-radius: 10px; font-size: 1.1rem; text-align: center;">

        <button onclick="joinQuiz()" class="btn btn-modern" style="width: 100%; padding: 1rem !important; font-size: 1.2rem !important; cursor: pointer;">
          <span style="pointer-events: none;">âœ… ENTRA</span>
        </button>
      </div>
    </div>

    <!-- Quiz Attivo per Partecipante -->
    <div id="participantQuiz" style="display: none;">
      <div class="info-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);padding: 0px;">
        <div id="waitingForQuestion" style="text-align: center;">
          <h4 style="font-family: 'Bangers', cursive; font-size: 1.8rem; margin-bottom: 1rem;">
            â³ IN ATTESA DELLA DOMANDA...
          </h4>
          <p style="font-size: 1.1rem; opacity: 0.9;">
            Ciao <span id="displayParticipantName" style="font-weight: 700; color: var(--accent-color);"></span>! ğŸ‘‹
          </p>
          <div style="font-size: 3rem; margin: 2rem 0;">
            <span class="emoji-float">ğŸº</span>
            <span class="emoji-float" style="animation-delay: 0.3s;">ğŸ¯</span>
            <span class="emoji-float" style="animation-delay: 0.6s;">ğŸ†</span>
          </div>
        </div>

        <div id="activeQuestion" style="display: none;">
          <div style="background: rgba(255,255,255,0.2); padding: 1.5rem; border-radius: 15px; margin-bottom: 1rem; text-align: center;">
            <h5 style="font-family: 'Bangers', cursive; font-size: 1.3rem; margin-bottom: 1rem;">
              ğŸ“ TAPPA <span id="currentTappaNumber"></span>
            </h5>
            <div id="questionDisplay" style="background: white; color: #333; padding: 1.5rem; border-radius: 10px; font-size: 1.2rem; font-weight: 600; margin-bottom: 1.5rem;"></div>
            
            <input type="text" id="participantAnswer" class="form-control" placeholder="La tua risposta..." style="margin-bottom: 1rem; padding: 1rem; border-radius: 10px; font-size: 1.1rem; text-align: center;">
            
            <button onclick="submitAnswer()" id="submitBtn" class="btn btn-modern" style="width: 100%; padding: 1rem !important; font-size: 1.2rem !important;">
              ğŸš€ INVIA RISPOSTA
            </button>
          </div>

          <div id="answerFeedback" style="display: none; background: rgba(0,0,0,0.3); padding: 1.5rem; border-radius: 15px; text-align: center; margin-top: 1rem;">
            <h5 style="font-family: 'Bangers', cursive; font-size: 1.8rem; margin-bottom: 0.5rem; color: #ffd23f;">
              âœ… RISPOSTA INVIATA!
            </h5>
            <p style="font-size: 1.1rem; margin: 0; color: white;">
              L'organizzatore annuncerÃ  il vincitore! ğŸ†
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Pannello di controllo Admin (visibile solo dopo login) -->
  <div id="adminControls" style="display: none; text-align: center; margin-top: 1.5rem; padding: 1.5rem; background: rgba(131, 56, 236, 0.1); border-radius: 15px; border: 2px dashed var(--party-purple);">
    <h5 style="font-family: 'Bangers', cursive; font-size: 1.3rem; color: var(--party-purple); margin-bottom: 1rem;">
      âš™ï¸ CONTROLLI AMMINISTRATORE
    </h5>
    <button onclick="toggleQuizVisibility()" id="toggleQuizBtn" class="btn btn-modern" style="padding: 0.8rem 2rem !important; margin: 0.5rem;">
      <span id="quizBtnIcon">ğŸ‘ï¸</span> <span id="quizBtnText">Mostra Quiz ai Partecipanti</span>
    </button>
    <button onclick="logoutAdmin()" class="btn" style="background: linear-gradient(135deg, #ff6b6b, #ee5a6f); color: white; border: none; padding: 0.8rem 2rem; border-radius: 50px; font-weight: 700; margin: 0.5rem;">
      ğŸšª Logout
    </button>
  </div>
</div>

<style>
/* Animazione per le risposte in arrivo */
@keyframes slideInAnswer {
  from {
    opacity: 0;
    transform: translateX(-20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.answer-item {
  animation: slideInAnswer 0.3s ease;
  padding: 1rem;
  margin-bottom: 0.8rem;
  background: white;
  border-radius: 12px;
  border-left: 5px solid var(--party-purple);
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  transition: transform 0.2s ease;
}

.answer-item:hover {
  transform: translateX(5px);
}

.answer-item.correct {
  border-left-color: #28a745;
  background: #f8fff9;
}

    /* Pulse per quiz attivo */
@keyframes pulse-quiz {
  0%, 100% {
    box-shadow: 0 0 0 0 rgba(131, 56, 236, 0.7);
  }
  50% {
    box-shadow: 0 0 0 20px rgba(131, 56, 236, 0);
  }
}

.quiz-active {
  animation: pulse-quiz 2s infinite;
}

/* Modal custom (senza Bootstrap) */
.modal-overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  z-index: 9998;
  animation: fadeIn 0.3s ease;
}

.modal-overlay.show {
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal-box {
  background: white;
  border-radius: 25px;
  width: 90%;
  max-width: 500px;
  overflow: hidden;
  animation: slideIn 0.3s ease;
  position: relative;
  z-index: 9999;
}

.modal-header-custom {
  background: linear-gradient(135deg, var(--party-purple), var(--party-pink));
  color: white;
  padding: 1.5rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.modal-header-custom h5 {
  font-family: 'Bangers', cursive;
  font-size: 1.8rem;
  letter-spacing: 2px;
  margin: 0;
}

.modal-close {
  background: none;
  border: none;
  color: white;
  font-size: 2rem;
  cursor: pointer;
  padding: 0;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 1;
  transition: transform 0.2s ease;
}

.modal-close:hover {
  transform: scale(1.2) rotate(90deg);
}

.modal-body-custom {
  padding: 2rem;
}

.modal-body-custom input {
  width: 100%;
  padding: 1rem;
  border: 2px solid #e0e0e0;
  border-radius: 10px;
  font-size: 1.1rem;
  text-align: center;
  margin-bottom: 1rem;
  box-sizing: border-box;
  font-family: 'Poppins', sans-serif;
  transition: border-color 0.3s ease;
}

.modal-body-custom input:focus {
  outline: none;
  border-color: var(--party-purple);
}

.modal-error {
  color: #ff6b6b;
  text-align: center;
  margin-top: 1rem;
  font-weight: 600;
  display: none;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateY(-50px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Form controls custom */
.form-control {
  width: 100%;
  padding: 0.8rem;
  border: 2px solid #e0e0e0;
  border-radius: 10px;
  font-size: 1rem;
  font-family: 'Poppins', sans-serif;
  box-sizing: border-box;
  transition: border-color 0.3s ease;
}

.form-control:focus {
  outline: none;
  border-color: var(--party-purple);
}

select.form-control {
  cursor: pointer;
  background: white;
}

textarea.form-control {
  resize: vertical;
  min-height: 80px;
  font-family: 'Poppins', sans-serif;
}
  </style>
	
<div class="section-title" id="cosa-si-festeggia">
   COSA SI FESTEGGIA
</div>

<div class="info-card" style="padding: 1.5rem; background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%); border-left: 5px solid #ff6b35;">
<p style="text-align: justify; line-height: 1.8;">
   <span style="font-size: 1.3rem; color: #ff6b35; font-weight: bold;">ğŸº San Tazzo Ã¨ il pub crawl piÃ¹ famoso di Cisano Bergamasco!</span>
   </br></br>
   <span style="color: #333; font-size: 1.05rem;">
   Il <b style="color: #d4af37;">protettore dei calici pieni</b>, il <b style="color: #d4af37;">santo patrono</b> di chi non si arrende mai davanti a un boccale di birra, colui che <b style="color: #ff6b35;">trasforma l'acqua in birra</b>.
   </span>
   </br></br>
   <div style="background: linear-gradient(90deg, #ffe5dc 0%, #fff3e0 100%); padding: 1.2rem; border-radius: 8px; border-left: 4px solid #ff6b35; margin: 1rem 0;">
      <span style="color: #ff6b35; font-size: 1.25rem; font-weight: bold; display: block; margin-bottom: 0.8rem;">
         ğŸš¶â€â™‚ï¸ğŸ’¨ IL PELLEGRINAGGIO SACRO ğŸ»
      </span>
      <span style="color: #2c3e50; font-size: 1.1rem; font-weight: 600; line-height: 1.7;">
         Il suo miracolo si rinnova ogni anno, il <b style="color: #ff6b35;">secondo sabato di novembre</b>, quando i pellegrini <b style="color: #d4af37; font-size: 1.15rem;">si mettono in cammino</b> per le vie di Cisano.
         </br></br>
         <span style="background: white; padding: 0.8rem; border-radius: 5px; display: inline-block; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
            ğŸ‘£ <b style="color: #ff6b35;">SI CAMMINA</b> di tappa in tappa attraverso le nostre contrade sacre<br/>
            ğŸº <b style="color: #ff6b35;">SI BEVE</b> per onorare San Tazzo in ogni luogo benedetto<br/>
            ğŸ‰ <b style="color: #ff6b35;">SI FESTEGGIA</b> brindando con compagni di avventura
         </span>
      </span>
   </div>
   </br></br>
   <div style="background: #ff6b35; color: white; padding: 1.2rem; border-radius: 10px; text-align: center; margin-top: 1rem; box-shadow: 0 4px 15px rgba(255,107,53,0.3);">
      <span style="font-size: 1.4rem; font-weight: bold; text-transform: uppercase; letter-spacing: 1px;">
         ğŸ”¥ Uomini e donne di valore e coraggio ğŸ”¥
      </span>
      </br></br>
      <span style="font-size: 1.2rem;">
         Preparate il fegato per <b style="text-decoration: underline;">sabato <span id="giorno_descr"></span> Novembre</b>
      </span>
      </br>
      <span style="font-size: 1.5rem; font-weight: bold; margin-top: 0.5rem; display: block;">
         SarÃ  la notte del riscatto,<br/>la notte di SAN TAZZO!! ğŸ»âœ¨
      </span>
   </div>
</p>
</div>

<div style="text-align: center; background: #f8f9fa; padding: 1.5rem; margin: 2rem 0; border-radius: 10px; border: 2px dashed #ff6b35;">
   <p style="font-size: 1.15rem; margin: 0; color: #2c3e50; line-height: 1.6;">
      ğŸ“ <b style="color: #ff6b35;">Di seguito troverai le tappe e i partecipanti</b>
      </br></br>
      <span style="background: #ffe5dc; padding: 0.5rem 1rem; border-radius: 5px; display: inline-block; margin-top: 0.5rem;">
         â° <b style="color: #ff6b35;">Una settimana prima dell'evento</b> verrai aggiornato sui dettagli della processione! ğŸ—ºï¸
      </span>
   </p>
</div>

<div class="hashtags">
  <span class="hashtag">#MolaMia</span>
  <span class="hashtag">#Santazzari</span>
  <span class="hashtag">#SanTazzo</span>
</div>
</div>

<div class="form-section" id="form_registrazione">
  <h3 style="text-align: center; color: black; font-family: 'Bangers', cursive; font-size: 2rem; margin-bottom: 1.5rem; letter-spacing: 1.5px; line-height: 1.3;">
    <span class="emoji-float">ğŸ“</span> ISCRIVITI! <span class="emoji-float">ğŸ«</span>
  </h3>
  
  <div style="max-width: 600px; margin: 0 auto; background: rgba(255,255,255,0.95); padding: 2rem; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
    <form id="registrationForm" onsubmit="registraPartecipante(event)">
      
      <!-- Nickname -->
      <div style="margin-bottom: 1.5rem;">
        <label style="display: block; font-weight: 600; color: #333; margin-bottom: 0.5rem; font-size: 1rem;">
          ğŸ­ Come vuoi essere chiamato?
        </label>
        <input 
          type="text" 
          id="regNickname" 
          class="form-control" 
          placeholder="Es: IlBarman, LaTequilera, MrSantazzo..." 
          required
          maxlength="30"
          style="width: 100%; padding: 0.9rem; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1rem;">
        <small style="color: #666; margin-top: 0.3rem; width:100%;">
                    â„¹ï¸ L'iscrizione non Ã¨ obbligatoria ma consigliata. La partecipazione Ã¨ completamente GRATUITA! ğŸ‰
        </small>
      </div>

      <!-- Messaggio di errore -->
      <div id="regError" style="display: none; background: #f8d7da; color: #721c24; padding: 1rem; border-radius: 10px; margin-bottom: 1rem; text-align: center; font-weight: 600;">
      </div>

      <!-- Bottone Submit -->
      <button 
        type="submit" 
        id="regSubmitBtn"
        class="btn btn-modern" 
        style="width: 100%; padding: 1.2rem !important; font-size: 1.2rem !important; margin-top: 0.5rem;">
        <span style="font-size: 1.3em;">ğŸ‰</span> ISCRIVITI ORA!
      </button>
      
    </form>
  </div>
</div>

    <!-- Bottone per visualizzare i partecipanti -->
    <button 
      id="visualizzaPartecipantiBtn" 
      class="btn btn-modern" 
      style="display: block; width: 100%; margin-top: 1.5rem;"
      onclick="mostraPartecipanti()">
      <span style="font-size: 1.2em;">ğŸ‘¥</span> Visualizza Partecipanti <span style="font-size: 1.2em;">ğŸ‰</span>
    </button>
    
    <!-- Sezione per la tabella dei partecipanti -->
    <div id="tableContainer" style="display: none; margin-top: 20px; background: white; padding: 2rem; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); max-width: 800px; margin-left: auto; margin-right: auto;">
      <h4 style="text-align: center; font-family: 'Bangers', cursive; font-size: 2rem; color: var(--party-purple); margin-bottom: 1.5rem; letter-spacing: 2px; line-height: 1.3;">
       I SANTAZZARI 2025
      </h4>
      <div>
        <table class="table table-modern" style="margin-bottom: 0; width: 100%;">
          <thead style="position: sticky; top: 0; z-index: 10;">
            <tr>
              <th style="text-align: left; padding: 1.2rem !important; font-size: 1.1rem;">ğŸ­ Nickname</th>
            </tr>
          </thead>
          <tbody id="partecipantiBody">
            <tr>
              <td colspan="2" style="text-align: center; padding: 2rem; opacity: 0.6;">
                Caricamento partecipanti...
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

<script>
// ============================================
// SISTEMA REGISTRAZIONE PARTECIPANTI FIREBASE
// ============================================

// Funzione per registrare un nuovo partecipante
function registraPartecipante(event) {
  event.preventDefault();
  
  if (!database) {
    alert('âŒ Firebase non configurato! Contatta l\'organizzatore.');
    return;
  }
  
  const nickname = document.getElementById('regNickname').value.trim();
  const submitBtn = document.getElementById('regSubmitBtn');
  const errorDiv = document.getElementById('regError');
  
  // Validazione
  if (!nickname) {
    showRegError('âš ï¸ Inserisci un nickname!');
    return;
  }
  
  if (nickname.length < 3) {
    showRegError('âš ï¸ Il nickname deve essere lungo almeno 3 caratteri!');
    return;
  }
  
  // Disabilita il form
  submitBtn.disabled = true;
  submitBtn.innerHTML = '<span style="font-size: 1.3em;">â³</span> Registrazione in corso...';
  errorDiv.style.display = 'none';
  
  // Controlla se il nickname esiste giÃ  (case-insensitive)
  database.ref('partecipanti').orderByChild('nicknameLower').equalTo(nickname.toLowerCase()).once('value')
    .then((snapshot) => {
      if (snapshot.exists()) {
        // Nickname giÃ  preso
        showRegError('ğŸ­ Questo nickname Ã¨ giÃ  stato scelto! Scegline un altro.');
        submitBtn.disabled = false;
        submitBtn.innerHTML = '<span style="font-size: 1.3em;">ğŸ‰</span> ISCRIVITI ORA!';
      } else {
        // Salva il nuovo partecipante
        const nuovoPartecipante = {
          nickname: nickname,
          nicknameLower: nickname.toLowerCase(), // Per controllo duplicati case-insensitive
          timestamp: Date.now(),
          dataIscrizione: new Date().toISOString()
        };
        
        return database.ref('partecipanti').push(nuovoPartecipante);
      }
    })
    .then((result) => {
      if (result) {
        // Successo!
        document.getElementById('registrationForm').reset();
        showRegistrationModal();
        submitBtn.disabled = false;
        submitBtn.innerHTML = '<span style="font-size: 1.3em;">ğŸ‰</span> ISCRIVITI ORA!';
        
        // Aggiorna il contatore
        aggiornaContatore();
      }
    })
    .catch((error) => {
      console.error('Errore registrazione:', error);
      showRegError('âŒ Errore nella registrazione. Riprova!');
      submitBtn.disabled = false;
      submitBtn.innerHTML = '<span style="font-size: 1.3em;">ğŸ‰</span> ISCRIVITI ORA!';
    });
}

function showRegError(message) {
  const errorDiv = document.getElementById('regError');
  errorDiv.textContent = message;
  errorDiv.style.display = 'block';
  setTimeout(() => {
    errorDiv.style.display = 'none';
  }, 5000);
}

// Funzione per mostrare e caricare i partecipanti
function mostraPartecipanti() {
  const container = document.getElementById('tableContainer');
  
  if (container.style.display === 'none') {
    container.style.display = 'block';
    caricaPartecipanti();
  } else {
    container.style.display = 'none';
  }
}

// Funzione per caricare i partecipanti da Firebase
function caricaPartecipanti() {
  if (!database) {
    document.getElementById('partecipantiBody').innerHTML = 
      '<tr><td colspan="2" style="text-align: center; padding: 2rem; color: #ff6b6b;">âŒ Firebase non configurato</td></tr>';
    return;
  }
  
  database.ref('partecipanti').orderByChild('timestamp').once('value')
    .then((snapshot) => {
      const tableBody = document.getElementById('partecipantiBody');
      tableBody.innerHTML = '';
      
      if (!snapshot.exists()) {
        tableBody.innerHTML = 
          '<tr><td style="text-align: center; padding: 2rem; opacity: 0.6;">Nessun partecipante ancora ğŸ­</td></tr>';
        return;
      }
      
      const partecipanti = [];
      snapshot.forEach((child) => {
        partecipanti.push(child.val());
      });
      
      // Ordina per timestamp decrescente (piÃ¹ recenti prima)
      partecipanti.sort((a, b) => b.timestamp - a.timestamp);
      
      partecipanti.forEach((partecipante) => {
        const row = document.createElement('tr');
        
        // Colonna Nickname
        const nicknameCell = document.createElement('td');
        nicknameCell.textContent = partecipante.nickname;
        nicknameCell.style.padding = '1rem';
        nicknameCell.style.fontWeight = '600';
        nicknameCell.style.fontSize = '1.05rem';
        
        row.appendChild(nicknameCell);
        tableBody.appendChild(row);
      });
    })
    .catch((error) => {
      console.error('Errore caricamento partecipanti:', error);
      document.getElementById('partecipantiBody').innerHTML = 
        '<tr><td style="text-align: center; padding: 2rem; color: #ff6b6b;">âŒ Errore nel caricamento</td></tr>';
    });
}

// Funzione per aggiornare il contatore
function aggiornaContatore() {
  if (!database) return;
  
  database.ref('partecipanti').once('value')
    .then((snapshot) => {
      const count = snapshot.numChildren();
      document.getElementById('contatorePartecipanti').textContent = count;
    })
    .catch((error) => {
      console.error('Errore contatore:', error);
    });
}

// Carica il contatore all'avvio
window.addEventListener('load', () => {
  if (database) {
    aggiornaContatore();
    
    // Aggiorna il contatore in tempo reale
    database.ref('partecipanti').on('value', (snapshot) => {
      const count = snapshot.numChildren();
      document.getElementById('contatorePartecipanti').textContent = count;
    });
  }
});
</script>

<br/>

<div class="container" id="tabellaTappe" >
  <div class="section-title" style="margin-top: 10px;">
     LE TAPPE
  </div> 
  </div>

   <div style="text-align: center; margin: 2rem 0;">
    <h4 style="font-family: 'Poppins', sans-serif; color: #555; font-weight: 300;">
      TAPPE DA DEFINIRSI
    </h4>
  </div> 

<div class="tappe-card" style="display: none;">
<table class="table table-modern" id="tabellaTappe" style="margin: 0;">
  <thead>
    <tr>
      <th scope="col" style="width: 100px; text-align: center;">ğŸ Tappa</th>
      <th scope="col" style="width: 100%;"> ğŸ“ Locale</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th scope="row" style="text-align: center; font-size: 1.5rem;">1</th>
      <td><a href="https://goo.gl/maps/1vBxcuhF5SZRmQpU7" class="tappa-link">ğŸº Mania</a></td>
    </tr>
    <tr>
      <th scope="row" style="text-align: center; font-size: 1.5rem;">2</th>
      <td><a href="https://maps.app.goo.gl/ekZTkTD2JrcJSxfK7" class="tappa-link">ğŸ» Baraonda (jet-lag)</a></td>
    </tr>
    <tr>
      <th scope="row" style="text-align: center; font-size: 1.5rem;">3</th>
      <td><a href="https://maps.app.goo.gl/nyfG6Hgft2uTpZvY6" class="tappa-link">ğŸ¹ Melograno</a></td>
    </tr>
    <tr>
      <th scope="row" style="text-align: center; font-size: 1.5rem;">4</th>
      <td><a href="https://maps.app.goo.gl/Q6MiRiaRJjjBpfr9A" class="tappa-link">â›ª Oratorio Cisano</a></td>
    </tr>
    <!-- <tr>
      <th scope="row" style="text-align: center; font-size: 1.5rem;">5</th>
      <td><a href="https://g.page/Abbazia-Birra?share" class="tappa-link">ğŸ» Abbazia</a></td>
    </tr> -->
    <tr>
      <th scope="row" style="text-align: center; font-size: 1.5rem;">5</th>
      <td><a href="https://g.page/birreria-logos?share" class="tappa-link">ğŸº Logos</a></td>
    </tr>
    <tr>
      <th scope="row" style="text-align: center; font-size: 1.5rem;">6</th>
      <td><a href="https://goo.gl/maps/hgHHM3PhoGPvJ6d29" class="tappa-link">ğŸ¥ƒ Pagani</a></td>
    </tr>
    <tr>
      <th scope="row" style="text-align: center; font-size: 1.5rem;">7</th>
      <td><a href="https://goo.gl/maps/1vBxcuhF5SZRmQpU7" class="tappa-link">ğŸ Mania (Gran Finale)</a></td>
    </tr>
  </tbody>
</table>
</div>

</div>

<!-- Modal Registrazione Avvenuta (Custom) -->
<div class="modal-overlay" id="registrationModal">
  <div class="modal-box">
    <div class="modal-header-custom">
      <h5>ğŸ‰ REGISTRAZIONE AVVENUTA</h5>
      <button class="modal-close" onclick="closeRegistrationModal()">&times;</button>
    </div>
    <div class="modal-body-custom" style="text-align: center; font-size: 1.2rem;">
      <p style="font-size: 1.5rem; margin: 0;"><b style="color: var(--party-pink);">Ti meriti uno shot! ğŸ¥ƒ</b></p>
      <button type="button" class="btn btn-modern" onclick="closeRegistrationModal(); location.reload();" style="width: 100%; padding: 1rem !important; margin-top: 1.5rem;">
        Chiudi
      </button>
    </div>
  </div>
</div>


<script>

const firebaseConfig = {
  apiKey: "AIzaSyBpNwx80lYHvV0rq7l-XCKSJUiyqWySC0c",
  authDomain: "santazzo-quiz.firebaseapp.com",
  databaseURL: "https://santazzo-quiz-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "santazzo-quiz",
  storageBucket: "santazzo-quiz.firebasestorage.app",
  messagingSenderId: "712685335775",
  appId: "1:712685335775:web:f44157b336900427e3656a"
};

// Inizializza Firebase
let database;
try {
  firebase.initializeApp(firebaseConfig);
  database = firebase.database();
  console.log("âœ… Firebase connesso!");
} catch (error) {
  console.error("âŒ Errore Firebase:", error);
  alert("âš ï¸ Configura Firebase! Vedi le istruzioni nel codice.");
}

// ============================================
// VARIABILI GLOBALI
// ============================================
const ADMIN_PASSWORD = "santazzo2025!"; // Cambia questa password!
let currentQuizData = null;
let participantNameGlobal = null;
let quizAnswers = [];
let quizListener = null;
let isQuizVisible = false; // Stato visibilitÃ  quiz

// ============================================
// FUNZIONI ADMIN
// ============================================
function showAdminLogin() {
  document.getElementById('adminLoginModal').classList.add('show');
  document.getElementById('adminPassword').focus();
}

function closeAdminModal() {
  document.getElementById('adminLoginModal').classList.remove('show');
  document.getElementById('adminPassword').value = '';
  document.getElementById('adminError').style.display = 'none';
}

function checkAdminPassword() {
  const password = document.getElementById('adminPassword').value;
  if (password === ADMIN_PASSWORD) {
    closeAdminModal();
    document.getElementById('adminPanel').style.display = 'block';
    document.getElementById('participantPanel').style.display = 'none';
    document.getElementById('adminControls').style.display = 'block';
    
    // Mostra automaticamente la sezione quiz all'admin
    document.getElementById('quizSection').style.display = 'block';
    
    // Inizia ad ascoltare le risposte
    listenToAnswers();
    
    // Carica lo stato del quiz da Firebase
    loadQuizVisibilityState();
    
    // Scroll alla sezione quiz
    setTimeout(() => {
      smoothScroll('quizSection', 20);
    }, 300);
  } else {
    document.getElementById('adminError').style.display = 'block';
    setTimeout(() => {
      document.getElementById('adminError').style.display = 'none';
    }, 3000);
  }
}

function logoutAdmin() {
  if (confirm('ğŸšª Vuoi uscire dal pannello amministratore?')) {
    // Nascondi pannelli admin
    document.getElementById('adminPanel').style.display = 'none';
    document.getElementById('adminControls').style.display = 'none';
    // NON nascondere il bottone Admin - Ã¨ sempre visibile ora
    
    // Mostra pannello partecipanti
    document.getElementById('participantPanel').style.display = 'block';
    
    // Nascondi quiz se non Ã¨ visibile per tutti
    if (!isQuizVisible) {
      document.getElementById('quizSection').style.display = 'none';
    }
    
    // Reset
    currentQuizData = null;
    quizAnswers = [];
    
    // Scroll in alto
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }
}

function toggleQuizVisibility() {
  if (!database) {
    alert('âŒ Firebase non configurato!');
    return;
  }

  isQuizVisible = !isQuizVisible;
  
  // Salva lo stato su Firebase
  database.ref('quizSettings/visible').set(isQuizVisible)
    .then(() => {
      updateQuizVisibilityUI();
      
      if (isQuizVisible) {
        alert('âœ… Quiz ora visibile a tutti i partecipanti! ğŸ¯');
      } else {
        alert('ğŸ‘ï¸ Quiz nascosto ai partecipanti (solo tu lo vedi)');
      }
    })
    .catch((error) => {
      console.error('Errore Firebase:', error);
      alert('âŒ Errore nel salvare le impostazioni');
    });
}

function updateQuizVisibilityUI() {
  const icon = document.getElementById('quizBtnIcon');
  const text = document.getElementById('quizBtnText');
  const btnQuiz = document.getElementById('btnQuiz');
  
  if (isQuizVisible) {
    icon.textContent = 'ğŸ™ˆ';
    text.textContent = 'Nascondi Quiz ai Partecipanti';
    btnQuiz.style.display = 'flex';
  } else {
    icon.textContent = 'ğŸ‘ï¸';
    text.textContent = 'Mostra Quiz ai Partecipanti';
    btnQuiz.style.display = 'none';
  }
}

function loadQuizVisibilityState() {
  if (!database) return;
  
  database.ref('quizSettings/visible').once('value')
    .then((snapshot) => {
      isQuizVisible = snapshot.val() || false;
      updateQuizVisibilityUI();
    })
    .catch((error) => {
      console.error('Errore nel caricare lo stato:', error);
    });
}

// Chiudi modal con ESC
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') {
    closeAdminModal();
  }
});

// Chiudi modal cliccando fuori (quando DOM Ã¨ pronto)
window.addEventListener('load', () => {
  const adminModal = document.getElementById('adminLoginModal');
  if (adminModal) {
    adminModal.addEventListener('click', (e) => {
      if (e.target.id === 'adminLoginModal') {
        closeAdminModal();
      }
    });
  }
  
  const regModal = document.getElementById('registrationModal');
  if (regModal) {
    regModal.addEventListener('click', (e) => {
      if (e.target.id === 'registrationModal') {
        closeRegistrationModal();
      }
    });
  }
});

function startQuiz() {
  const tappa = document.getElementById('adminTappaSelect').value;
  const question = document.getElementById('adminQuestion').value.trim();
  const answerInput = document.getElementById('adminAnswer').value.trim();

  if (!question || !answerInput) {
    alert('âš ï¸ Inserisci sia la domanda che la risposta!');
    return;
  }

  if (!database) {
    alert('âŒ Firebase non configurato! Controlla la console.');
    return;
  }

  // Separa le risposte per virgola e normalizza
  const answers = answerInput.split(',').map(a => a.trim().toLowerCase()).filter(a => a.length > 0);

  currentQuizData = {
    tappa: tappa,
    question: question,
    answer: answerInput.toLowerCase(), // Mantiene per compatibilitÃ 
    answers: answers, // Array di risposte corrette
    active: true,
    startTime: Date.now()
  };

  quizAnswers = [];

  // Salva il quiz su Firebase
  database.ref('currentQuiz').set(currentQuizData)
    .then(() => {
      // Pulisci le vecchie risposte
      return database.ref('answers').remove();
    })
    .then(() => {
      // Update admin UI
      document.getElementById('adminQuestionDisplay').textContent = question;
      document.getElementById('activeQuizAdmin').style.display = 'block';
      document.getElementById('answersReceived').innerHTML = '<p style="text-align: center; opacity: 0.6;">In attesa di risposte...</p>';
      
      alert('âœ… Quiz avviato per la Tappa ' + tappa + '! ğŸš€');
    })
    .catch((error) => {
      console.error('Errore Firebase:', error);
      alert('âŒ Errore nell\'avvio del quiz: ' + error.message);
    });
}

function endQuiz() {
  if (!currentQuizData || !database) return;

  // Conferma chiusura
  if (!confirm('âš ï¸ Vuoi terminare il quiz? I partecipanti non potranno piÃ¹ rispondere.')) {
    return;
  }

  // Disattiva il quiz su Firebase
  database.ref('currentQuiz/active').set(false)
    .then(() => {
      if (currentQuizData) {
        currentQuizData.active = false;
      }

      // Mostra tutte le risposte finali ordinate
      let resultHTML = '<div style="background: rgba(255,215,0,0.3); padding: 1.2rem; border-radius: 12px; margin-bottom: 1rem; text-align: center; border: 2px solid #ffd700;">';
      resultHTML += '<h5 style="font-family: \'Bangers\', cursive; color: #ff6b35; font-size: 1.6rem; margin-bottom: 0.5rem;">ï¿½ QUIZ TERMINATO!</h5>';
      resultHTML += '<p style="font-weight: 600; color: #555;">Annuncia tu il vincitore! ğŸ¤</p>';
      resultHTML += '</div>';

      // Trova le risposte corrette ordinate per tempo
      const correctAnswers = quizAnswers.filter(a => a.correct).sort((a, b) => a.timestamp - b.timestamp);
      
      if (correctAnswers.length > 0) {
        resultHTML += '<div style="background: #d4edda; padding: 1rem; border-radius: 10px; margin-bottom: 1rem; border-left: 5px solid #28a745;">';
        resultHTML += '<h6 style="font-weight: 700; color: #155724; margin-bottom: 0.8rem;">âœ… RISPOSTE CORRETTE (ordine di arrivo):</h6>';
        correctAnswers.forEach((answer, index) => {
          const medal = index === 0 ? 'ğŸ¥‡' : index === 1 ? 'ğŸ¥ˆ' : index === 2 ? 'ğŸ¥‰' : `${index + 1}Â°`;
          const timeStr = currentQuizData && currentQuizData.startTime 
            ? `â±ï¸ ${((answer.timestamp - currentQuizData.startTime) / 1000).toFixed(2)}s` 
            : '';
          resultHTML += `
            <div style="background: white; padding: 0.8rem; margin-bottom: 0.5rem; border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
              <div>
                <strong style="font-size: 1.1rem;">${medal} ${answer.name}</strong>
                <div style="font-size: 0.95rem; color: #666; margin-top: 0.2rem;">ğŸ’¬ ${answer.answer}</div>
              </div>
              <div style="text-align: right; font-size: 0.9rem; color: #888;">
                ${timeStr}
              </div>
            </div>
          `;
        });
        resultHTML += '</div>';
      }

      // Mostra risposte sbagliate
      const wrongAnswers = quizAnswers.filter(a => !a.correct).sort((a, b) => a.timestamp - b.timestamp);
      if (wrongAnswers.length > 0) {
        resultHTML += '<div style="background: #f8d7da; padding: 1rem; border-radius: 10px; border-left: 5px solid #dc3545;">';
        resultHTML += '<h6 style="font-weight: 700; color: #721c24; margin-bottom: 0.8rem;">âŒ RISPOSTE SBAGLIATE:</h6>';
        resultHTML += '<div style="max-height: 250px; overflow-y: auto;">';
        wrongAnswers.forEach((answer) => {
          const timeStr = currentQuizData && currentQuizData.startTime 
            ? `â±ï¸ ${((answer.timestamp - currentQuizData.startTime) / 1000).toFixed(2)}s` 
            : '';
          resultHTML += `
            <div style="background: white; padding: 0.6rem; margin-bottom: 0.4rem; border-radius: 8px; font-size: 0.95rem;">
              <strong>${answer.name}:</strong> ${answer.answer}
              <span style="opacity: 0.6; margin-left: 0.5rem;">${timeStr}</span>
            </div>
          `;
        });
        resultHTML += '</div></div>';
      }

      if (quizAnswers.length === 0) {
        resultHTML += '<p style="text-align: center; opacity: 0.6; padding: 1rem;">Nessuna risposta ricevuta</p>';
      }

      document.getElementById('answersReceived').innerHTML = resultHTML;

      // Nascondi il pannello dopo 20 secondi
      setTimeout(() => {
        const confirmClose = confirm('âœ… Vuoi chiudere il pannello quiz? (Puoi rimanere aperto per rivedere le risposte)');
        if (confirmClose) {
          document.getElementById('activeQuizAdmin').style.display = 'none';
          document.getElementById('adminQuestion').value = '';
          document.getElementById('adminAnswer').value = '';
          currentQuizData = null;
          quizAnswers = [];
        }
      }, 20000);
    })
    .catch((error) => {
      console.error('Errore Firebase:', error);
      alert('âŒ Errore nella chiusura del quiz: ' + error.message);
    });
}

function listenToAnswers() {
  if (!database) return;

  // Ascolta le nuove risposte in tempo reale
  database.ref('answers').on('child_added', (snapshot) => {
    const answer = snapshot.val();
    if (answer && currentQuizData && currentQuizData.active) {
      quizAnswers.push(answer);
      quizAnswers.sort((a, b) => a.timestamp - b.timestamp); // Ordina per tempo
      updateAdminAnswers();
    }
  });
}

// ============================================
// FUNZIONI PARTECIPANTE
// ============================================
function joinQuiz() {
  const name = document.getElementById('participantName').value.trim();
  if (!name) {
    alert('âš ï¸ Inserisci il tuo nome!');
    return;
  }

  if (!database) {
    alert('âŒ Firebase non configurato! Controlla la console.');
    return;
  }

  participantNameGlobal = name;
  document.getElementById('displayParticipantName').textContent = name;
  document.getElementById('participantLogin').style.display = 'none';
  document.getElementById('participantQuiz').style.display = 'block';

  // Ascolta i cambiamenti del quiz in tempo reale
  listenToQuizUpdates();
}

function submitAnswer() {
  if (!currentQuizData || !currentQuizData.active || !database) return;

  const answer = document.getElementById('participantAnswer').value.trim();
  if (!answer) {
    alert('âš ï¸ Inserisci una risposta!');
    return;
  }

  // Verifica se la risposta Ã¨ corretta confrontando con tutte le risposte possibili
  const userAnswerLower = answer.toLowerCase();
  let isCorrect = false;
  
  if (currentQuizData.answers && Array.isArray(currentQuizData.answers)) {
    // Usa l'array di risposte se disponibile
    isCorrect = currentQuizData.answers.some(correctAnswer => userAnswerLower === correctAnswer);
  } else {
    // Fallback per compatibilitÃ  con vecchio formato
    isCorrect = userAnswerLower === currentQuizData.answer;
  }

  const answerData = {
    name: participantNameGlobal,
    answer: answer,
    correct: isCorrect,
    timestamp: Date.now()
  };

  // Disabilita il pulsante immediatamente
  document.getElementById('submitBtn').disabled = true;
  document.getElementById('participantAnswer').disabled = true;

  // Salva la risposta su Firebase
  database.ref('answers').push(answerData)
    .then(() => {
      // Mostra sempre lo stesso feedback (senza dire se Ã¨ corretto)
      const feedback = document.getElementById('answerFeedback');
      feedback.style.display = 'block';
    })
    .catch((error) => {
      console.error('Errore Firebase:', error);
      alert('âŒ Errore nell\'invio della risposta: ' + error.message);
      document.getElementById('submitBtn').disabled = false;
      document.getElementById('participantAnswer').disabled = false;
    });
}

function listenToQuizUpdates() {
  if (!database) return;

  // Ascolta i cambiamenti del quiz in tempo reale
  database.ref('currentQuiz').on('value', (snapshot) => {
    const quiz = snapshot.val();
    if (quiz && quiz.active) {
      currentQuizData = quiz;
      showQuestionToParticipant();
    } else {
      // Quiz terminato o non attivo
      document.getElementById('waitingForQuestion').style.display = 'block';
      document.getElementById('activeQuestion').style.display = 'none';
      currentQuizData = null;
    }
  });
}

function showQuestionToParticipant() {
  document.getElementById('waitingForQuestion').style.display = 'none';
  document.getElementById('activeQuestion').style.display = 'block';
  document.getElementById('currentTappaNumber').textContent = currentQuizData.tappa;
  document.getElementById('questionDisplay').textContent = currentQuizData.question;
  document.getElementById('participantAnswer').value = '';
  document.getElementById('participantAnswer').disabled = false;
  document.getElementById('submitBtn').disabled = false;
  document.getElementById('answerFeedback').style.display = 'none';
}

function updateAdminAnswers() {
  if (!document.getElementById('adminPanel') || document.getElementById('adminPanel').style.display === 'none') return;

  let html = '';
  quizAnswers.forEach((answer, index) => {
    const timeInSeconds = ((answer.timestamp - currentQuizData.startTime) / 1000).toFixed(2);
    html += `
      <div class="answer-item ${answer.correct ? 'correct' : ''}">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.3rem;">
          <strong style="font-size: 1.1rem;">#${index + 1} - ${answer.name}</strong>
          <span style="font-size: 0.9rem; opacity: 0.7;">â±ï¸ ${timeInSeconds}s</span>
        </div>
        <div style="font-size: 1.05rem; padding: 0.5rem; background: ${answer.correct ? '#d4edda' : '#f8d7da'}; border-radius: 8px; margin-top: 0.3rem;">
          ğŸ’¬ <strong>Risposta:</strong> ${answer.answer}
          ${answer.correct ? '<span style="color: #28a745; font-weight: 700; margin-left: 0.5rem;">âœ… CORRETTA</span>' : '<span style="color: #dc3545; font-weight: 700; margin-left: 0.5rem;">âŒ SBAGLIATA</span>'}
        </div>
      </div>
    `;
  });

  document.getElementById('answersReceived').innerHTML = html || '<p style="text-align: center; opacity: 0.6;">In attesa di risposte...</p>';
}

// ============================================
// INIT: Controlla connessione Firebase all'avvio
// ============================================
window.addEventListener('load', () => {
  if (!database) {
    console.warn('âš ï¸ Firebase non configurato. Segui le istruzioni nel codice per configurarlo.');
  }
});
</script>

<!-- Footer Divertente -->
<footer style="background: linear-gradient(135deg, #1a1a2e, #16213e); color: white; padding: 2rem 1rem; margin-top: 3rem; text-align: center;">
  <div class="container">
    <p style="font-family: 'Bangers', cursive; font-size: 1.3rem; margin-bottom: 0.8rem; letter-spacing: 1.5px; line-height: 1.3;">
      ğŸº SANTAZZO<br class="d-md-none">
    </p>
    <div style="margin-top: 1.5rem; font-size: 1.5rem;">
      <span class="emoji-float">ğŸ»</span>
      <span class="emoji-float" style="animation-delay: 0.2s;">ğŸŠ</span>
      <span class="emoji-float" style="animation-delay: 0.4s;">ğŸ¥³</span>
      <span class="emoji-float" style="animation-delay: 0.6s;">ğŸ‰</span>
      <span class="emoji-float" style="animation-delay: 0.8s;">ğŸº</span>
      <!-- Pulsante Admin Login (SEMPRE VISIBILE) -->
<div class="container" style="text-align: center; margin: 2rem auto;">
  <button onclick="showAdminLogin()" id="adminLoginBtn" class="btn" style="background: rgba(0,0,0,0.1); border: 2px dashed rgba(0,0,0,0.3); padding: 0.5rem 1.5rem; border-radius: 50px; font-size: 0.9rem; color: #666; cursor: pointer;">
    ğŸ”
  </button>
</div>
    </div>
  </div>
</footer>

<style>
  /* Footer responsive */
  @media (min-width: 768px) {
    footer {
      padding: 3rem 0 !important;
      margin-top: 5rem !important;
    }
    
    footer p:first-of-type {
      font-size: 2rem !important;
      margin-bottom: 1rem !important;
      letter-spacing: 2px !important;
    }
    
    footer p:nth-of-type(2) {
      font-size: 1rem !important;
    }
    
    footer > div > div:last-child {
      margin-top: 2rem !important;
      font-size: 2rem !important;
    }
  }
</style>

<script language="javascript">
//core
    let dSanTazzo=new Date()        
    //ottengo santazzo di quest'anno
    dSanTazzo=getDataSanTazzo(new Date().getFullYear())
   if (dSanTazzo.toDateString()==new Date().toDateString()){
     //oggi Ã¨ santazzo!
      document.getElementById("timer").innerHTML=""  
      document.getElementById("titolo").innerHTML="<h1>OGGI Ãˆ SANTAZZO!!!</h1>"  
      document.getElementById("data").innerHTML="<h1>RISCALDA IL FEGATO!</h1>"
   }else if(dSanTazzo<new Date()){//santazzo superato
      dSanTazzo=getDataSanTazzo(new Date().getFullYear()+1)
      updateTimer()
      setInterval('updateTimer()', 1000);
    }else{
      updateTimer()
      setInterval('updateTimer()', 1000);
    }
    
    if (dSanTazzo.toDateString()!=new Date().toDateString()){
      //data
      var giornoSanTazzo = dSanTazzo.toDateString().split(" ")[2];
      document.getElementById("data").innerHTML='Sabato ' + giornoSanTazzo + ' Novembre ';;
      document.getElementById("giorno_descr").innerHTML=giornoSanTazzo
      //titolo
      document.getElementById("titolo").innerHTML="<h1>SANTAZZO "+dSanTazzo.getFullYear()+"</h1>"
    }

    //scroll navbar
    let getpart=0
  let navbar = document.getElementsByClassName("navbar");
  let navbar_item=document.getElementsByClassName("navbar-text");
  let numR=Math.random() * 200;
  let numG=Math.random() * 200
  let numB=Math.random() * 200

  navbar[0].style="background-color:black;background: linear-gradient(to top, rgba("+numR+", "+numG+", "+numB+", 0), rgba("+numR+", "+numG+", "+numB+",0.55));"
  
  
// ============================================
// FUNZIONI MODAL REGISTRAZIONE
// ============================================
function closeRegistrationModal() {
  document.getElementById('registrationModal').classList.remove('show');
}

function showRegistrationModal() {
  document.getElementById('registrationModal').classList.add('show');
}

// ============================================
// SMOOTH SCROLL (senza jQuery)
// ============================================
function smoothScroll(targetId, offset = 80) {
  const element = document.getElementById(targetId);
  if (element) {
    const navbar = document.querySelector('.navbar');
    const navbarHeight = navbar ? navbar.offsetHeight : 60;
    const targetPosition = element.getBoundingClientRect().top + window.pageYOffset - navbarHeight - offset;
    
    window.scrollTo({
      top: targetPosition,
      behavior: 'smooth'
    });
  }
}

// Bottoni di navigazione sotto il timer
document.getElementById('btnCosa')?.addEventListener('click', () => {
  smoothScroll('cosa-si-festeggia', 20);
});

document.getElementById('btnIscriviti')?.addEventListener('click', () => {
  smoothScroll('form_registrazione', 20);
  // Focus sull'input dopo lo scroll
  setTimeout(() => {
    document.getElementById('regNickname')?.focus();
  }, 500);
});

document.getElementById('btnTappe')?.addEventListener('click', () => {
  smoothScroll('tabellaTappe', 20);
});

document.getElementById('btnQuiz')?.addEventListener('click', () => {
  smoothScroll('quizSection', 20);
});

// ============================================
// CONTROLLA VISIBILITÃ€ QUIZ PER PARTECIPANTI
// ============================================
function checkQuizVisibilityForParticipants() {
  if (!database) return;
  
  // Ascolta i cambiamenti della visibilitÃ  del quiz
  database.ref('quizSettings/visible').on('value', (snapshot) => {
    const visible = snapshot.val() || false;
    const quizSection = document.getElementById('quizSection');
    const btnQuiz = document.getElementById('btnQuiz');
    const adminPanel = document.getElementById('adminPanel');
    
    // Se non Ã¨ admin (pannello admin nascosto)
    if (adminPanel.style.display === 'none' || !adminPanel.style.display) {
      if (visible) {
        quizSection.style.display = 'block';
        btnQuiz.style.display = 'flex';
      } else {
        quizSection.style.display = 'none';
        btnQuiz.style.display = 'none';
      }
    }
  });
}

// Avvia il controllo quando la pagina Ã¨ caricata
window.addEventListener('load', () => {
  if (database) {
    checkQuizVisibilityForParticipants();
  }
});


  let btnpart=0 
  function AddInputNome() {
    if (btnpart==0){
      document.getElementById("partecipa")
    .innerHTML='<form class="form-inline" name="FormEmail" action="javascript:AddPartecipante()" style="padding-top:8px">'+
    '<div class="form-group sm-3 mb-2 col-9">'+
    '<label for="inputNominativo" class="sr-only">Nominativo</label>'+
    '<input type="text" class="form-control" style="width:100%" id="inputNominativo" placeholder="Inserire un nominativo" required>'+
  '</div>'+
  '<div class="col-auto">'+
  '<button type="submit" class="btn btn-success mb-2">invia!</button>'+
  '</div>'+
  '</form>'
    btnpart=1
    }else{
      document.getElementById("partecipa").innerHTML=''
      btnpart=0
    }

  }

  function AddPartecipante(){
          var nome="";
          nome=document.getElementById("inputNominativo").value
          if (nome !=""){
          $.ajax({
              url: "./functions/AddPartecipante.php",
              method:'GET',
              data: {"nome":nome},

              success: function(result){
                //$("#det").html(result);
                location.href="./index.php";
              }});    
          }
  }


function AggiungiEmail(){
 let email=document.forms["FormEmail"]["inputEmail"].value
 if (email!=""){
  fetch("./functions/AddEmail.php?email=" + encodeURIComponent(email))
    .then(response => response.text())
    .then(result => {
      if (result == "true"){
        showRegistrationModal();
      } else {
        const emailEs = document.getElementById('emailEs');
        if (emailEs) {
          emailEs.innerHTML = "&nbsp;&nbsp;&nbsp;Email giÃ  esistente.";
        }
      }
    })
    .catch(error => console.error('Errore:', error));
 }
}

function GetPartecipanti(){
if (getpart==0){
  fetch("./functions/GetPartecipanti.php")
    .then(response => response.text())
    .then(result => {
      const partecipanti = document.getElementById('partecipanti');
      if (partecipanti) {
        partecipanti.innerHTML = result;
      }
    })
    .catch(error => console.error('Errore:', error));
  getpart=1
}else{
  getpart=0
  const partecipanti = document.getElementById('partecipanti');
  if (partecipanti) {
    partecipanti.innerHTML = "";
  }
} 

}

    function percentuale(){
      var scrollpercent = (document.body.scrollTop + document.documentElement.scrollTop) / (document.documentElement.scrollHeight - document.documentElement.clientHeight);
      if(scrollpercent>0.2){
        navbar[0].style="background-color:rgb("+numR+", "+numG+", "+numB+");transition-duration: 2s;";
      }else{
        navbar[0].style="background-color:black;background: linear-gradient(to top, rgba("+numR+", "+numG+", "+numB+", 0), rgba("+numR+", "+numG+", "+numB+",0.55));";
      }
    }
   
 function updateTimer() {
    future=dSanTazzo
    now = new Date();
    diff = future - now;

    days = Math.floor(diff / (1000 * 60 * 60 * 24))
    hours = Math.floor(diff / (1000 * 60 * 60))
    mins = Math.floor(diff / (1000 * 60))
    secs = Math.floor(diff / 1000)

    d = days;
    h = hours - days * 24;
    m = mins - hours * 60;
    s = secs - mins * 60;
    
    document.getElementById("timer").innerHTML =
        '<div><span class="number">' + d + '</span><span>giorni</span></div>' +
        '<div><span class="number">' + h + '</span><span>ore</span></div>' +
        '<div><span class="number">' + m + '</span><span>minuti</span></div>' +
        '<div><span class="number">' + s + '</span><span>secondi</span></div>';
}

    function getDataSanTazzo(anno) {
      let dSanTazzo=new Date()
      let fdata=false
      for (let i = 1; i < 10 && fdata==false; i++) {
        dSanTazzo.setFullYear(anno,10,i)
        if (dSanTazzo.getDay()==6){
          fdata=true
          dSanTazzo.setFullYear(anno,10,i+7)
        }
      }
      dSanTazzo.setMinutes(0)
      dSanTazzo.setSeconds(0)
      dSanTazzo.setHours(0)
      dSanTazzo.setMilliseconds(0)
      return dSanTazzo
    }

    // Example starter JavaScript for disabling form submissions if there are invalid fields
(function() {
  'use strict';
  window.addEventListener('load', function() {
    // Fetch all the forms we want to apply custom Bootstrap validation styles to
    var forms = document.getElementsByClassName('needs-validation');
    // Loop over them and prevent submission
    var validation = Array.prototype.filter.call(forms, function(form) {
      form.addEventListener('submit', function(event) {
        if (form.checkValidity() === false) {
          event.preventDefault();
          event.stopPropagation();
        }
        form.classList.add('was-validated');
      }, false);
    });
  }, false);
})();


  </script>

<!-- Modal Admin Login (Custom senza Bootstrap) -->
<div class="modal-overlay" id="adminLoginModal">
  <div class="modal-box">
    <div class="modal-header-custom">
      <h5>ğŸ” LOGIN AMMINISTRATORE</h5>
      <button class="modal-close" onclick="closeAdminModal()">&times;</button>
    </div>
    <div class="modal-body-custom">
      <input type="password" id="adminPassword" placeholder="Password amministratore">
      <button onclick="checkAdminPassword()" class="btn btn-modern" style="width: 100%; padding: 1rem !important;">
        âœ… ACCEDI
      </button>
      <p id="adminError" class="modal-error">
        âŒ Password errata!
      </p>
    </div>
  </div>
</div>

</body>
</html>
