<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SanTazzo</title>  
<style>
    /*navbar*/
.nav-item:hover{ text-decoration:underline;}
.navbar:hover {opacity:1;}
h4.text-success {
  font-size: 20px;
}


#timer {
    font-size: 3em;
    font-weight: 100;
    color:blue;  
}

#timer div {
    display: inline-block;
    min-width: 68px;
}

#timer div span {
    color:blue;
    display: block;
    font-size: .35em;
    font-weight: 400;
}
  </style>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@1.16.1/dist/umd/popper.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
</head>

<body onscroll="percentuale()">
	<nav class="navbar fixed-top navbar-expand-lg navbar-dark ">
	  <div class="container">
  	  <a class="navbar-brand" href="./index.php" >SANTAZZO</a>
      <a class="nav-link active" style="font-weight: bold;color:white" id="scrollToPartecipa" >Partecipa!</a>
      <a class="nav-link active" style="font-weight: bold;color:white" id="scrollToTappe" >Vedi tappe</a>
	 	</div>
	</nav>

<div style="background-image: url(./img/2.jpg);background-attachment: fixed;background-repeat:no-repeat; background-size:cover; background-position:center center;height:650px;">
<div class="container">
    <div class="row">
    <div class="col-sm-0"></div>
      <div class="col-sm-12" style="align:center;padding-top:100px;" >
        <div style="background-color:rgba(50,50,50,0.9);padding-top:8px;padding-bottom:8px;border:solid 3px black;border-radius:15px;">
            <div id="titolo" style="text-align: center;" class="text-light"></div> 
            <div id="data" class="text-light font-weight-light" style="text-align: center;"></div>    
            <div id="timer" style="text-align: center;"></div>  
        </div>
      </div> 
      <div class="col-sm-0"></div>     
    </div>  
</div>
</div>

<div class="container"><div class="row"><div class="col-md-12 col-xs-12" style="align:center;padding-top:10px" >
<hr>
<div class="d-flex justify-content-center"><img src="./img/alert-triangle.svg" alt="Alert"><h4 class="text-success">
  &nbsp Ore 20:00 ritrovo al Bar Mania &nbsp 
</h4><img src="./img/alert-triangle.svg" alt="Alert"></div> 
<hr>

<div class="d-flex justify-content-center">
  <h3>
    Domande?  
  </h3>
</div>
<div class="d-flex justify-content-center">
<a class="btn btn-outline-primary" role="button" href="https://telegram.me/santazzo">Unisciti al Gruppo Telegram <img src="./img/icons8-telegram-app.svg" alt="Alert"></a>
</div>
<hr>
<br/>
<div class="d-flex justify-content-center">
  <h4>
  COSA SI FESTEGGIA
</h4>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABmJLR0QA/wD/AP+gvaeTAAAB70lEQVRoge2YwWvaUBzHv7+oMSbOISL0vosd9n8ZyDx63Bg7lTKhB0HwtNDBGIyB1+JlVWnZX7HhodTLLj31sqLdus44jU1eT8LMZJNfXkml7wM55CXf936fJLw8HqBQKNYa4gZrA0fILKSRt1i1aDKLiAIlEDVKIGrYs5BTqkqdhayOrWahtUQJRI0SiBq2wExP+LKKmCV1dl9sgYlpONxskGkqOeJm2QKukTzhZv/uSz/mZtkCD7//fM/NBsn8GH3gZtkCmQeD9tTQv3Hzc9xk4jwzi3W5ebYANZszY+q+5Obn6O71czqou9x8qGnUbNtdQXiz9KI7WTyWIIhsq/36KEwN8TBhALCKZvV3f+wL4NWf7eNP7xbuM0vVhXMiYZtFcxftcOOzl9NBnFL1iQ/sacAjABh37IXrcwEfONWIdsI++TnS/sRWxz5M5y43iUSZBFoimwfiCSCegMjmQQItEniazl1uyioekPgGggS3XbjbJv/j/q6F7gpKIGqUQNQogahRAsuoX/x6vEqbDKQL1IajiudrX4Ltnq/1agPnmezxpK1Pts9EKm2M3wL4Z5ECtD/xUi/2NkjKpoAUgfrwquAh9hECWysO+xWeX25spPthxw79CdWGo4onYr3ViwcAUUCMPt/GJ6VQKNaMGxymkUxc8MV5AAAAAElFTkSuQmCC" alt="Alert"> 
</div>

<p style="text-align: justify;">
<b>San Tazzo</b>  non è solo una data o un appuntamento annuale, San Tazzo è molto di più: un <b>credo</b> , un <b>sentimento</b> , un <b>popolo</b>. È il nostro stile, il nostro mantra, la nostra cultura, il legame che unisce tante persone per un evento unico.
</br> Come di consueto lo spirito e le modalità rimangono le medesime: si <b class="text-danger">cammina</b>  e si <b class="text-danger">beve</b>  facendo tappa nei locali delle nostre contrade.
</br><b>Uomini e donne di valore e coraggio, preparate il fegato per sabato <b id="giorno_descr"></b> Novembre: sarà la notte del riscatto, la notte di San Tazzo !!</b>
</p>
<p style="text-align: justify;">
Di seguito troverai le tappe e i partecipanti. Una settima prima dell'evento verrai aggiornato sui dettagli della processione !!
</p>


<b>#MolaMia</b></br>
<b>#Santazzari</b></br>
<b>#SanTazzo</b></br>
<b>#Morethananight</b></br>
<hr>
  <div class="embed-responsive" style="padding-bottom: 700px;">
      <iframe 
        class="embed-responsive-item" 
        src="https://docs.google.com/forms/d/e/1FAIpQLSec6nmDdqh3WiahU5q6wJWVM76X95qcIG_gUG4qIfabFMd5Dw/viewform?embedded=true" 
        frameborder="0" 
        marginheight="0" 
        marginwidth="0" 
        style="width: 100%; height: 700px; border-radius: 8px; box-shadow: 0px 4px 8px rgba(0,0,0,0.2);">
      Caricamento…
      </iframe>
    </div>

    <!-- Bottone per visualizzare i partecipanti -->
    <button 
      id="visualizzaPartecipantiBtn" 
      class="btn btn-primary mt-4" 
      style="display: block; width: 100%; font-weight: bold; font-size: 1.2em; background-color: #007bff; border: none; border-radius: 8px;"
      onclick="mostraPartecipanti()">
      Visualizza Partecipanti Registrati
    </button>

    <!-- Sezione per la tabella dei partecipanti, nascosta inizialmente -->
    <div id="tableContainer" style="display: none; margin-top: 20px;">
      <table class="table table-striped table-hover" style="border-radius: 8px; overflow: hidden; box-shadow: 0px 4px 8px rgba(0,0,0,0.2);">
        <thead class="thead-dark">
          <tr>
            <th style="text-align: center;">Nome</th>
          </tr>
        </thead>
        <tbody id="partecipantiBody">
          <!-- I dati dei partecipanti saranno caricati qui -->
        </tbody>
      </table>
    </div>
  </div>




	 <script>
    // URL del foglio Google Sheets pubblicato in formato CSV
    const googleSheetCSVUrl = 'https://docs.google.com/spreadsheets/d/1sHIA_rPXD348pFjid1afcasABuhVC2orGV9PoPwqRPs/gviz/tq?tqx=out:csv';

    // Funzione per mostrare titolo, tabella e caricare i partecipanti
    function mostraPartecipanti() {
      document.getElementById('titoloPartecipanti').style.display = 'block';
      document.getElementById('tableContainer').style.display = 'block';
      caricaPartecipanti();
    }

    // Funzione per caricare e visualizzare i partecipanti
    async function caricaPartecipanti() {
      try {
        const response = await fetch(googleSheetCSVUrl);
        const csvData = await response.text();

        // Trasforma CSV in array
        const rows = csvData.split('\n').slice(1);
        const tableBody = document.getElementById('partecipantiBody');
        tableBody.innerHTML = ''; // Pulisce la tabella

        rows.forEach(row => {
          const [timestamp, nome] = row.split(',');

          if (nome) {
            const newRow = document.createElement('tr');
            const nomeCell = document.createElement('td');
            nomeCell.textContent = nome.replace(/"/g, ''); // Rimuove eventuali virgolette
            nomeCell.style.textAlign = 'center';
            newRow.appendChild(nomeCell);
            tableBody.appendChild(newRow);
          }
        });
      } catch (error) {
        console.error("Errore durante il caricamento dei dati:", error);
      }
    }
  </script>
<hr>

<br/>
<div class="d-flex justify-content-center">
  <h4>
    TAPPE 
  </h4>
</div>
<div class="container">
<table class="table" id ="tabellaTappe">
  <thead class="thead-dark">
    <tr>
      <th scope="col">#</th>
      <th scope="col">Tappa</th>
    </tr>
  </thead>
  <tbody>
<tr>
      <th scope="row">1</th>
      <td><a href="https://goo.gl/maps/1vBxcuhF5SZRmQpU7">Mania</a></td>
    </tr>
<tr>
      <th scope="row">2</th>
      <td> <a href="https://goo.gl/maps/U2w6h85BBCzwfcpRA">Fashion e Oratorio Villa</a></td>
    </tr>
<tr>
        <th scope="row">3</th>
        <td><a href="https://maps.app.goo.gl/nyfG6Hgft2uTpZvY6">Melograno</a></td>
    </tr>
    <tr>
        <th scope="row">4</th>
        <td><a href="https://maps.app.goo.gl/Q6MiRiaRJjjBpfr9A">Oratorio Cisano</a></td>
    </tr>
	      <tr>
      <th scope="row">5</th>
      <td><a href="https://g.page/Abbazia-Birra?share">Abbazia</a></td>
    </tr>
    <tr>
      <th scope="row">6</th>
      <td><a href="https://g.page/birreria-logos?share">Logos</a></td>
    </tr>
    <tr>
      <th scope="row">7</th>
      <td><a href="https://goo.gl/maps/hgHHM3PhoGPvJ6d29">Pagani</a></td>
    </tr>
    <tr>
      <th scope="row">8</th>
      <td><a href="https://goo.gl/maps/1vBxcuhF5SZRmQpU7">Mania</a></td>
    </tr>
  </tbody>
</table>

</div>

<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalCenterTitle">Registrazione avvenuta con successo!</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
       <b>Controlla la tua email!</b><br/>
       <b class="text-success">Ti meriti uno shot!</b> 
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" onclick="location.reload();" data-dismiss="modal">Chiudi</button>
      </div>
    </div>
  </div>
</div>

<script language="javascript">
//core
    let dSanTazzo=new Date()        
    //ottengo santazzo di quest'anno
    dSanTazzo=getDataSanTazzo(new Date().getFullYear())
   if (dSanTazzo.toDateString()==new Date().toDateString()){
     //oggi è santazzo!
      document.getElementById("timer").innerHTML=""  
      document.getElementById("titolo").innerHTML="<h1>OGGI È SANTAZZO!!!</h1>"  
      document.getElementById("data").innerHTML="<h1>RISCALDA IL FEGATO!</h1>"
   }else if(dSanTazzo<new Date()){//santazzo superato
      dSanTazzo=getDataSanTazzo(new Date().getFullYear()+1)
      updateTimer()
      setInterval('updateTimer()', 1000);
    }else{
      updateTimer()
      setInterval('updateTimer()', 1000);
    }
    
    if (dSanTazzo.toDateString()!=new Date().toDateString()){
      //data
      var giornoSanTazzo = dSanTazzo.toDateString().split(" ")[2];
      document.getElementById("data").innerHTML='Sabato ' + giornoSanTazzo + ' Novembre ';;
      document.getElementById("giorno_descr").innerHTML=giornoSanTazzo
      //titolo
      document.getElementById("titolo").innerHTML="<h1>SANTAZZO "+dSanTazzo.getFullYear()+"!</h1>"
    }

    //scroll navbar
    let getpart=0
  let navbar = document.getElementsByClassName("navbar");
  let navbar_item=document.getElementsByClassName("navbar-text");
  let numR=Math.random() * 200;
  let numG=Math.random() * 200
  let numB=Math.random() * 200

  navbar[0].style="background-color:black;background: linear-gradient(to top, rgba("+numR+", "+numG+", "+numB+", 0), rgba("+numR+", "+numG+", "+numB+",0.55));"
  
  

$( "#scrollToPartecipa" ).click(function() {
  $( "#inputNominativo" ).focus();  
});


$( "#scrollToTappe" ).click(function() {
  $('html,body').animate({
    scrollTop: $('#tabellaTappe').offset().top
  },'slow');
});



setTimeout(() => {
  if (document.getElementById('bnpartecipa')){
  document.getElementById('bnpartecipa').click();
  }
}, 1000);
  let btnpart=0 
  function AddInputNome() {
    if (btnpart==0){
      document.getElementById("partecipa")
    .innerHTML='<form class="form-inline" name="FormEmail" action="javascript:AddPartecipante()" style="padding-top:8px">'+
    '<div class="form-group sm-3 mb-2 col-9">'+
    '<label for="inputNominativo" class="sr-only">Nominativo</label>'+
    '<input type="text" class="form-control" style="width:100%" id="inputNominativo" placeholder="Inserire un nominativo" required>'+
  '</div>'+
  '<div class="col-auto">'+
  '<button type="submit" class="btn btn-success mb-2">invia!</button>'+
  '</div>'+
  '</form>'
    btnpart=1
    }else{
      document.getElementById("partecipa").innerHTML=''
      btnpart=0
    }

  }

  function AddPartecipante(){
          var nome="";
          nome=document.getElementById("inputNominativo").value
          if (nome !=""){
          $.ajax({
              url: "./functions/AddPartecipante.php",
              method:'GET',
              data: {"nome":nome},

              success: function(result){
                //$("#det").html(result);
                location.href="./index.php";
              }});    
          }
  }


function AggiungiEmail(){
 let email=document.forms["FormEmail"]["inputEmail"].value
 if (email!=""){
  $.ajax({
              url: "./functions/AddEmail.php",
              method:'GET',
              data: {"email":email},

              success: function(result){
                if (result == "true"){
                   $('#exampleModalCenter').modal("show")
                }else{
                  $('#emailEs').html("&nbsp&nbsp&nbspEmail già esistente.")
                }
              }});  
 }
}

function GetPartecipanti(){
if (getpart==0){
  $.ajax({
              url: "./functions/GetPartecipanti.php",
              success: function(result){
                $("#partecipanti").html(result);
              }}); 
  getpart=1

}else{
  getpart=0
  $("#partecipanti").html("");
} 

}

    function percentuale(){
      var scrollpercent = (document.body.scrollTop + document.documentElement.scrollTop) / (document.documentElement.scrollHeight - document.documentElement.clientHeight);
      if(scrollpercent>0.2){
        navbar[0].style="background-color:rgb("+numR+", "+numG+", "+numB+");transition-duration: 2s;";
      }else{
        navbar[0].style="background-color:black;background: linear-gradient(to top, rgba("+numR+", "+numG+", "+numB+", 0), rgba("+numR+", "+numG+", "+numB+",0.55));";
      }
    }
   
 function updateTimer() {
    //future=getDataSanTazzo(new Date().getFullYear())
    future=dSanTazzo
    now = new Date();
    diff = future - now;

    days = Math.floor(diff / (1000 * 60 * 60 * 24))
    hours = Math.floor(diff / (1000 * 60 * 60))
    mins = Math.floor(diff / (1000 * 60))
    secs = Math.floor(diff / 1000)

    d = days;
    h = hours - days * 24;
    m = mins - hours * 60;
    s = secs - mins * 60;
    document.getElementById("timer")
   .innerHTML =
        '<div class="text-light">' + d + '<span class="text-light">giorni</span></div>' +
        '<div class="text-light">' + h + '<span class="text-light">ore</span></div>' +
        '<div class="text-light">' + m + '<span class="text-light">minuti</span></div>' +
        '<div class="text-light">' + s + '<span class="text-light">secondi</span></div>';
}

    function getDataSanTazzo(anno) {
      let dSanTazzo=new Date()
      let fdata=false
      for (let i = 1; i < 10 && fdata==false; i++) {
        dSanTazzo.setFullYear(anno,10,i)
        if (dSanTazzo.getDay()==6){
          fdata=true
          dSanTazzo.setFullYear(anno,10,i+7)
        }
      }
      dSanTazzo.setMinutes(0)
      dSanTazzo.setSeconds(0)
      dSanTazzo.setHours(0)
      dSanTazzo.setMilliseconds(0)
      return dSanTazzo
    }

    // Example starter JavaScript for disabling form submissions if there are invalid fields
(function() {
  'use strict';
  window.addEventListener('load', function() {
    // Fetch all the forms we want to apply custom Bootstrap validation styles to
    var forms = document.getElementsByClassName('needs-validation');
    // Loop over them and prevent submission
    var validation = Array.prototype.filter.call(forms, function(form) {
      form.addEventListener('submit', function(event) {
        if (form.checkValidity() === false) {
          event.preventDefault();
          event.stopPropagation();
        }
        form.classList.add('was-validated');
      }, false);
    });
  }, false);
})();


  </script>

</body>
</html>
